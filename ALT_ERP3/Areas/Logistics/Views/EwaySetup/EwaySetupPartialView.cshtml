@model ALT_ERP3.Areas.Logistics.Models.EwaySetupVM
@using Common;
@{
    ViewBag.Title = "LRSetupVM";
    Layout = null;
}
<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        GetMyFavorites('@Model.ViewDataId');

        if ('@Model.AllBranch'=="True" || '@Model.AllBranch'=="true") {
            $("#AllBranch").prop("checked", true);
            $("#UserBranch").prop("checked", false);
        } else if ('@Model.UserBranch'=="True" || '@Model.UserBranch'=="true") {
            $("#AllBranch").prop("checked", false);
            $("#UserBranch").prop("checked", true);
        }
        $("#AllBranch").change(function () {
            $("#AllBranch").prop("checked", true);
            $("#UserBranch").prop("checked", false);
        });
        $("#UserBranch").change(function () {
            $("#AllBranch").prop("checked", false);
            $("#UserBranch").prop("checked", true);
        });

        if ('@Model.ConsoleForAllBranch'=="True" || '@Model.ConsoleForAllBranch'=="true") {
            $("#ConsoleForAllBranch").prop("checked", true);
        }
        if ('@Model.ConsoleForUserBranch' == "True" || '@Model.ConsoleForUserBranch' == "true") {
            $("#ConsoleForUserBranch").prop("checked", true);
        }
        




        //Generate Eway Properties
        loadSuppltType();
        loadSubSuppltType("I");
        $("#GenSupplyType").change(function () {
            loadSubSuppltType($("#GenSupplyType").val());
        });
        loadDocType();
        loadTRNType();
        loadVehicleType();

        //Multi Vehicle Eway Properties
        MULloadReasonCode();

        //BPart Eway Properties
        BPartloadReasonCode();

        //Extension Eway Properties
        EXTloadConsignmentCode();
        EXTloadTRNType();
        EXTloadExtendReasonCode();

        //Cancel Eway Properties
        CANloadCancelReasonCode();
        $('#Submit').click(function (event) {
            event.preventDefault();
            if ($("#AllBranch").is(":checked") == false && $("#UserBranch").is(":checked") == false) {
                alert('Please Select AllBranch Or UserBranch To Set Restriction On EwayBills...');
                return;
            }
            if ($("#ConsoleForAllBranch").is(":checked") == false && $("#ConsoleForUserBranch").is(":checked") == false) {
                alert('Please Select AllBranch Or UserBranch To Set Restriction On Console EwayBills...');
                return;
            }


            var url = '@Url.Action("SaveData")';
            @* iX9: Data from individual field is passed on to the Model and then to Controller for Saving *@
            var ModelData = {};

            ModelData["AllBranch"] = $("#AllBranch").is(":checked");
            ModelData["UserBranch"] = $("#UserBranch").is(":checked");
            ModelData["ConsoleForAllBranch"] = $("#ConsoleForAllBranch").is(":checked");
            ModelData["ConsoleForUserBranch"] = $("#ConsoleForUserBranch").is(":checked");
            ModelData["AutoConsole"] = $("#AutoConsole").is(":checked");

            ModelData["AutoExtendMailID"] = $("#AutoExtendMailID").val();

            ModelData["GenSupplyType"] = $("#GenSupplyType").val();
            ModelData["GenSubType"] = $("#GenSubType").val();
            ModelData["GenDoctype"] = $("#GenDoctype").val();
            ModelData["GenTranType"] = $("#GenTranType").val();
            ModelData["GenVehicleType"] = $("#GenVehicleType").val();
            ModelData["MulReason"] = $("#MulReason").val();
            ModelData["BPartReason"] = $("#BPartReason").val();
            ModelData["ExtConsignIs"] = $("#ExtConsignIs").val();
            ModelData["ExtTranType"] = $("#ExtTranType").val();
            ModelData["ExtReason"] = $("#ExtReason").val();
            ModelData["CanReason"] = $("#CanReason").val();
            


            ModelData["Mode"] = '@Model.Mode';
            ModelData["Header"] = '@Model.Header';

            var DTO = { mModel: ModelData };
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    if (data.Status == 'Success') {
                        $('.spinner').hide();
                        window.location.href = "/DashBoard/SetUP";
                        $("#ErrorMessage").hide();
                    }
                    else {
                        $('.spinner').hide();
                        alert(data.Message);
                    }
                },
            });
        });
    });
    function loadSuppltType() {
        event.preventDefault();
        var url = '@Url.Action("GetSuppltType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#GenSupplyType").empty();
                $.each(result, function (i, item) {
                    $("#GenSupplyType").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#GenSupplyType').val('@Model.GenSupplyType').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function loadSubSuppltType(value) {
        event.preventDefault();
        var url = '@Url.Action("GetSubSuppltType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: { SupplyType: value },
            success: function (result) {
                $("#GenSubType").empty();
                $.each(result, function (i, item) {
                    $("#GenSubType").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#GenSubType').val('@Model.GenSubType').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function loadDocType() {
        event.preventDefault();
        var url = '@Url.Action("GetDocType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#GenDoctype").empty();
                $.each(result, function (i, item) {
                    $("#GenDoctype").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#GenDoctype').val('@Model.GenDoctype').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function loadTRNType() {
        event.preventDefault();
        var url = '@Url.Action("GetTrasactType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#GenTranType").empty();
                $.each(result, function (i, item) {
                    $("#GenTranType").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#GenTranType').val('@Model.GenTranType').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function loadVehicleType() {
        event.preventDefault();
        var url = '@Url.Action("GetVehicleType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#GenVehicleType").empty();
                $.each(result, function (i, item) {
                    $("#GenVehicleType").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#GenVehicleType').val('@Model.GenVehicleType').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function MULloadReasonCode() {
        event.preventDefault();
        var url = '@Url.Action("GetReasonCode")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#MulReason").empty();
                $.each(result, function (i, item) {
                    $("#MulReason").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#MulReason').val('@Model.MulReason').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function BPartloadReasonCode() {
        event.preventDefault();
        var url = '@Url.Action("GetReasonCode")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#BPartReason").empty();
                $.each(result, function (i, item) {
                    $("#BPartReason").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#BPartReason').val('@Model.BPartReason').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function EXTloadConsignmentCode() {
        event.preventDefault();
        var url = '@Url.Action("GetConsignmentStatus")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#ExtConsignIs").empty();
                $.each(result, function (i, item) {
                    $("#ExtConsignIs").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#ExtConsignIs').val('@Model.ExtConsignIs').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function EXTloadTRNType() {
        event.preventDefault();
        var url = '@Url.Action("GetTrasactType")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#ExtTranType").empty();
                $.each(result, function (i, item) {
                    $("#ExtTranType").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#ExtTranType').val('@Model.ExtTranType').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function EXTloadExtendReasonCode() {
        event.preventDefault();
        var url = '@Url.Action("GetExtendReasonCode")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#ExtReason").empty();
                $.each(result, function (i, item) {
                    $("#ExtReason").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#ExtReason').val('@Model.ExtReason').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
    function CANloadCancelReasonCode() {
        event.preventDefault();
        var url = '@Url.Action("GetCancelReasonCode")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#CanReason").empty();
                $.each(result, function (i, item) {
                    $("#CanReason").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#CanReason').val('@Model.CanReason').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
</script>
<style>
    fieldset {
        border: 1px solid #ddd !important;
        margin: 0;
        padding: 10px;
        position: relative;
        border-radius: 4px;
        background-color: #f5f5f5;
        padding-left: 5px !important;
    }

    legend {
        margin-left: 1%;
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 0px;
        border: 1px solid #ddd;
        border-radius: 15px;
        padding: 5px 45px 5px 45px;
        background-color: white;
        width: auto;
        color: red;
    }
</style>
<header class="header fixed-top" style="position:fixed;background-color:lightgray;padding:6px;width:100%;margin-top:0%;">
    <div class="fixhead">
        <b class="CodeSt">@Model.Header</b>
        <span class="tools pull-right">
            <a href="~/DashBoard/SetUP" class="btn btn-danger" style="color:white;font-weight:bolder;font-size:13px;padding:3px 10px;" id="Cancel2">X</a>
        </span>
        <span class="tools pull-right">
            <b class="CodeSt">@Model.Header</b>
        </span>
        <button class="fa fa-heart pull-right" type="submit" onclick="AddToFavorite('@Model.ViewDataId','@Model.OptionCode')" title="Add/Remove from My Favorites" id="MyFavorites" style="color: rgb(145,142,142); background-color: transparent; border: none; font-size: 20px; height: 27px; margin-right: 5px;margin-top:5px;" name="MyFavorites"></button>

        <span class="tools pull-right" style="margin-right: 15px;">
        </span>
    </div>
</header>
<section class="panel" style="margin-bottom:0px;">
    <div class="panel-body">
        <div class="form-horizontal " id="LCSetupMaster" role="form" style="margin-top:25px;">
            <fieldset class=" col-md-12" style="margin-top:0%;">
                <legend>@Model.Header</legend>
                <div class="panel panel-default" style="height:420px;">
                    <div class="panel-body" style="padding-top: 5px;">
                        <div class="tab">
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable6')" id="Generate" style="width:140px;">Basic Info</button>
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable')" style="width:140px;">Generate EwayBill</button>
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable2')" style="width:160px;">Multi Vehicle EwayBill</button>
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable3')" style="width:140px;">B-Part EwayBill</button>
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable4')" style="width:140px;">Extend EwayBill</button>
                            <button class="tablinks" onclick="openCity(event, 'divLedgerTable5')" style="width:140px;">Cancel EwayBill</button>
                        </div>
                        <div id="divLedgerTable6" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-2 control-label" title="Users Allow To See Eawybills Using Branchwise." style="color:black;font-weight:bold;">Allow EwayBills:</label>
                                <div class="col-sm-1 control-label" style="padding-top:0px;">
                                    All Branch:  @Html.RadioButtonFor(x => x.AllBranch, "AllBranch", new { @name = "EwayBranch", @style = "padding-left:0px;width:20px;height:20px;" })
                                </div>
                                <div class="col-sm-2 control-label" style="padding-top:0px;">
                                    User Branch: @Html.RadioButtonFor(x => x.UserBranch, "UserBranch", new { @name = "EwayBranch", @style = "padding-left:0px;width:20px;height:20px;" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" title="Users Allow To See Eawybills Using Branchwise." style="color:black;font-weight:bold;">Allow Console EwayBills:</label>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;width:auto;">All Branch:</label>
                                <div class="col-sm-1 control-label" style="padding-top:0px;width: auto;">
                                    @Html.CheckBoxFor(x => x.ConsoleForAllBranch, new { @id = "ConsoleForAllBranch", @name = "ConsoleForAllBranch", @class = "form-control", @Value = Model.ConsoleForAllBranch, style = "height: 20px;width: 35px;" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;width:auto;">User Branch:</label>
                                <div class="col-sm-1 control-label" style="padding-top:0px;">
                                    @Html.CheckBoxFor(x => x.ConsoleForUserBranch, new { @id = "ConsoleForUserBranch", @name = "ConsoleForUserBranch", @class = "form-control", @Value = Model.ConsoleForUserBranch, style = "height: 20px;width: 35px;" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" title="Auto Extend Eway Bill Result To This Email ID." style="color:black;font-weight:bold; ">Email ID:</label>
                                <div class="col-sm-7 control-label" style="padding-top:0px;">
                                    @Html.TextBoxFor(x => x.AutoExtendMailID, new { @maxlength = "150", @class = "form-control", @style = "width:100%;margin-top:2px;", @Value = Model.AutoExtendMailID })
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-4 control-label" title="Auto Generate Console Or Update B-part When Consignment Loading." style="color:black;font-weight:bold; ">Auto Generate Console/ B-Part When Consignment Loading:</label>
                                <div class="col-sm-1 control-label" style="padding-top:0px;">
                                    @Html.CheckBoxFor(x => x.AutoConsole, new { @maxlength = "150", @class = "form-control", @style = "width:20px;height: 25px;margin-top:2px;", @Value = Model.AutoConsole })
                                </div>
                            </div>
                        </div>
                        <div id="divLedgerTable" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Supply Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.GenSupplyType, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Sub Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.GenSubType, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Doc Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.GenDoctype, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Transa. Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.GenTranType, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Vehicle Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.GenVehicleType, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div id="divLedgerTable2" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Reason Code:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.MulReason, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div id="divLedgerTable3" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Reason Code:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.BPartReason, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div id="divLedgerTable4" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Consign is:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.ExtConsignIs, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Transa. Type:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.ExtTranType, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Extend Code:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.ExtReason, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div id="divLedgerTable5" class="tabcontent" style="height: 380px;border: 1px solid;">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Cancel Code:</label>
                                <div class="col-sm-2">
                                    @Html.DropDownListFor(m => m.CanReason, DropdownHelper.EmptyList(), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <script>
                            function openCity(evt, cityName) {
                                var i, tabcontent, tablinks;
                                tabcontent = document.getElementsByClassName("tabcontent");
                                for (i = 0; i < tabcontent.length; i++) {
                                    tabcontent[i].style.display = "none";
                                }
                                tablinks = document.getElementsByClassName("tablinks");
                                for (i = 0; i < tablinks.length; i++) {
                                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                                }
                                document.getElementById(cityName).style.display = "block";
                                evt.currentTarget.className += " active";
                            }
                            document.getElementById("Generate").click();

                        </script>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>
</section>
<footer class="footer-section" style="height:33px;position:fixed;background-color:#4B4A4A;padding:3px;color:white;">
    <div class="row">
        <div class="col-sm-5">
        </div>
        <div class="col-sm-3" style="margin-top:4px;color:white;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
            ALT AIR-3.0, Shruham Software
        </div>
        <div class="col-sm-4">
            <div class="pull-right">
                @if (Model.Mode != "View")
                {
                    if (Model.Mode == "Delete")
                    {
                        <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnDelete">Delete</button>
                    }
                    else
                    {
                        <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="Submit">Save</button>
                    }
                }
                <a href="~/DashBoard/SetUP" class="btn btn-danger" style="font-size: 13px;padding:3px 12px;" id="Cancel">Cancel</a>
            </div>
        </div>
    </div>
</footer>
@Html.HiddenFor(x => x.Document)