@model GridOption
@using Common;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutMenu.cshtml";
}

<link href="~/Content/js/jquery-multi-select/css/multi-select.css" rel="stylesheet" />
<script src="~/Content/js/jquery-multi-select/js/jquery.multi-select.js"></script>
<script src="~/Content/js/jquery-multi-select/js/jquery.quicksearch.js"></script>
<style>
    .ui-jqgrid tr.jqgrow td {
        /*white-space: pre-wrap !important;*/
        height: auto;
        vertical-align: text-top;
        font-family: Tahoma;
        font-size: 9pt;
    }

    .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default {
        border: 1px solid lightgray;
    }

    .ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus {
        border: 1px solid white;
    }

    .btncolor {
        background-color: olive;
        color: white;
    }

    .ui-widget-content {
        background: unset;
    }

    /*.ui-icon {
        background-color: darkgrey;
    }*/

    .ui-jqgrid .ui-pg-table td {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .btn {
        font-size: 9pt;
        font-family: Tahoma;
        padding: 4px 12px;
    }

    h5 {
        font-size: 18px;
        margin-top: 5px;
    }

    .ui-jqgrid .ui-paging-info {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .ui-jqgrid .ui-pg-input {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .ui-jqgrid .ui-pg-selbox {
        font-size: 9pt;
        font-family: Tahoma;
    }
</style>
<style>
    .col-sm-2 {
        width: 10.666667%;
    }

    .form-group {
        margin-bottom: 8px;
    }

    .form-control {
        height: 28px;
        border: 1px solid #BBBABA;
        color: black;
    }

    .form-horizontal .control-label {
        padding-top: 5px;
        color: black;
    }

    .CodeSt {
        font-size: 18px;
    }

    .fixhead {
        text-transform: uppercase;
    }

    table {
        border-collapse: unset;
    }
</style>

<script type="text/javascript">

    $(document).ready(function () {
        document.getElementById("headerdiv").style.backgroundColor = '@Session["headerdivcolor"]';
        document.getElementById("headercaption").style.color = '@Session["headercaptioncolor"]';
        document.getElementById("fixedbottom").style.backgroundColor = '@Session["bottomcolor"]';
        $("#viewcode").val('@Model.ViewDataId');
        $("#hdnformatname").val('@Model.ViewDataId');
        loadAccount()
        $('select').select2();
        $('#Fromdate').val('@Model.FromDate');
        $('#ToDate').val('@Model.ToDate');
        $('#btnrefresh').click(function (event) {
            event.preventDefault();
            var Date = ($('#Fromdate').val() + '-' + $('#ToDate').val());
            var url = '@Url.Action("GetData")' + '?Date=' + Date + '&AccountName=' + $('#Group').val();
            $.ajax({
                type: "POST",
                dataType: "json",
                cache: false,
                url: url,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    if (data.Status == 'Success') {
                        $.each(data, function (i, item) {
                            $('#HighLowSummary').html(data.Html);
                        });
                    }
                },
                error: function (ex) {
                    alert("Error occured while processing your request." + ex);
                }
            });
            return false;
        });

        $('#btnexcel').click(function () {
            var Date = ($('#Fromdate').val() + '-' + $('#ToDate').val());
            var sUrlpath = window.open('@Url.Action("GetExcel")?Date=' + Date + '&AccountName=' + $('#Group').val())
        });

        $('#btnPrint').click(function () {
            var Date = ($('#Fromdate').val() + '-' + $('#ToDate').val());
            var sUrlpath = window.open('@Url.Action("GetPDF")?Date=' + Date + '&AccountName=' + $('#Group').val())
        });

    });



    function loadAccount() {
        var url = '@Url.Action("GetGroupList")';
        $('#Group').select2({
            minimumInputLength: 0,
            placeholder: 'Search',
            ajax: {
                url: url,
                dataType: 'json',
                quietMillis: 100,
                enableFiltering: true,
                allowClear: true,
                minimumInputLength: 0,
                multiple: true,
                width: 300,
                data: function (term, page) {
                    return {
                        types: ["exercise"],
                        limit: -1,
                        term: term
                    };
                },
                results: function (data, page) {
                    clientObj = JSON.stringify(data);
                    return {
                        results: $.map(data, function (item) {
                            return {

                                text: item.Name,
                                id: item.Code
                            }
                        })
                    };
                }
            },
            initSelection: function (element, callback) {
                var elementText = $(element).attr('data-init-text');
                xcallback({ "term": elementText });
            },
            formatResult: function (exercise) {
                return "<div class='row-fluid'><div class=''><span class='span1'><div style='color:" + exercise.alias + "'>" + exercise.text +
                    "</div></span></div></div>";
            },
            formatSelection: function (exercise) {
                return "<div class='row-fluid'><div class=''><span class='span1'><div style='color:" + exercise.alias + "'>" + exercise.text +
                    "</div></span></div></div>";
            },
        })

    };



</script>

@*<div class="row">
    <div class="col-md-12">
        <section class="panel" style="margin-bottom:7px;">
            <header class="panel-heading" style="background:beige;padding:6px;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="col-md-4"><b>Highest-Lowest Account Balance</b></div>
                        <div class="col-md-4 pull-right">
                            <div class="input-group input-large" data-date-format="dd/mm/yyyy">
                                <input type="text" class="form-control dpd1" name="from" id="Fromdate" data-date-format="dd/mm/yyyy">
                                <span class="input-group-addon">To</span>
                                <input type="text" class="form-control dpd2" name="to" id="ToDate" data-date-format="dd/mm/yyyy">
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <div class="row">
                <div class="col-xs-12">
                    <div class="col-md-1" style="padding-left:6px;font-family:Tahoma;padding-top:5px;font-size:9pt; width:unset;">
                        Group
                    </div>
                    <div class="col-sm-2">
                        <input type="text" id="Group" class="input-large search-query" style="width: 100%;" />
                    </div>
                    <button class="btn btn-info btn-sm" id="btnrefresh"><i class="fa fa-refresh"></i></button>
                    <button class="btn btn-success btn-sm" id="btnexcel"><i class="fa fa-file-excel-o"></i>Excel</button>
                    <button class="btn btn-success btn-sm" id="btnPrint"><i class="fa fa-file-excel-o"></i>Print</button>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-12" id="header">
                    <div class="col-md-2" style="padding-left:6px;font-family:Tahoma;padding-top:5px;font-size:9pt;width:unset;">
                        <b>Opening Balance :</b>
                    </div>
                    <div class="col-md-2" id="openb" style="padding-left:6px;font-family:Tahoma;padding-top:5px;font-size:9pt;">

                    </div>
                </div>
            </div>
            <br />
            <div id="HighLowSummary">
                @Html.Partial("HighLowAcBal", new GridOption())
            </div>
        </section>
    </div>
</div>*@
<header class="header fixed-top" id="headerdiv" style="position:fixed;background-color:lightgray;padding:6px;width:100%;margin-top:3px;">
    <div class="fixhead">
        <div class="col-md-5" style="padding-left:unset;width:unset;">
            <b class="CodeSt" id="headercaption">Highest-Lowest Account Balance</b>
        </div>
        <div class="col-md-1" style="padding-left:6px;font-family:Tahoma;padding-top:5px;font-size:9pt; width:unset;">
            Group
        </div>
        <div class="col-md-3">
            <input type="text" id="Group" class="input-large search-query" style="width: 100%;" />
        </div>
        <div class="col-md-4 pull-right" style="padding-right:unset;">
            <div class="input-group input-large" data-date-format="dd/mm/yyyy">
                <input type="text" class="form-control dpd1" name="from" id="Fromdate" data-date-format="dd/mm/yyyy">
                <span class="input-group-addon">To</span>
                <input type="text" class="form-control dpd2" name="to" id="ToDate" data-date-format="dd/mm/yyyy">
            </div>
        </div>
        <div class="col-md-2">
            <button class="btn btn-info btn-sm" id="btnrefresh" title='Refresh'><i class="fa fa-refresh"></i></button>
            <button class="btn btn-success btn-sm" id="btnexcel" title='Excel'><i class="fa fa-file-o"></i></button>
            <button class="btn btn-warning btn-sm" id="btnPrint" title='Print'><i class="fa fa-list"></i></button>
        </div>
    </div>
</header>
<section class="panel">
    <div class="panel-body" style="margin-top:34px;padding-left:6px;padding-right:6px;">
        <br />
        <div id="HighLowSummary">
            @Html.Partial("HighLowAcBal", new GridOption())
        </div>
    </div>
</section>
<footer class="footer-section" id="fixedbottom" style="position:fixed;background-color:lightgray;padding:6px;color:unset;">
    <div class="row">
        <div class="col-sm-4">
        </div>
        <div class="col-sm-4" style="text-align:center;margin-top:8px;color:black">
            T.FAT ERP-iX9 by Suchan Software Private Limited
        </div>
        <div class="col-sm-4">
            <div class="pull-right">
            </div>
        </div>
    </div>
</footer>
<input type="hidden" id="hdnPurchArray" />
<input type="hidden" id="hdnPurchCodeArray" />