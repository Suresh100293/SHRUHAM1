@model ALT_ERP3.Areas.Logistics.Models.EwayBillVM
@using Common;
@{
    ViewBag.Title = "LRSetupVM";
    Layout = null;
}
<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>
<style>
    textarea {
        resize: none;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        CANloadCancelReasonCode();

        $("#btnCanEway").click(function (event) {
            event.preventDefault();
            var url = '@Url.Action("CancelEWayBill")';
            var ModelData = {};
            ModelData["Document"] = $("#ConsignmentKey").val();
            ModelData["SearchEway"] = $("#CANSearchEway").val();

            ModelData["EWB_EwayNo"] = $("#CAN_EwayNo").val();
            ModelData["EWB_CancelReasonCode"] = $("#CAN_CancelReasonCode").val();
            ModelData["EWB_CancelReasonRemark"] = $("#CAN_CancelReasonRemark").val();

            var DTO = { Model: ModelData };
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    if (data.Status == 'Success') {
                        alert(data.errormsg);
                        location.reload();
                    }
                    else {
                        alert(data.errormsg);
                    }
                },
            });

        });

    });
    function CANloadCancelReasonCode() {
        event.preventDefault();
        var url = '@Url.Action("GetCancelReasonCode")';
        $.ajax({
            type: 'POST',
            url: url,
            dataType: 'json',
            data: {  },
            success: function (result) {
                $("#CAN_CancelReasonCode").empty();
                $.each(result, function (i, item) {
                    $("#CAN_CancelReasonCode").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#CAN_CancelReasonCode').val('@Model.EWB_CancelReasonCode').attr("selected", "selected");
                $('.spinner').hide();
            },
            error: function (ex) {
                alert("Error occured while processing your request." + ex);
            }
        });
        return false;
    };
</script>
<div class="col-sm-12">
    <hr style="margin-top:5px!important;margin-bottom:8px!important;border:1px solid #ad2783" />
    <div class="col-sm-12" style="padding-bottom: 5px!important;">
        <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">EwayBill No:<span style="color:red;">*</span></label>
        <div class="col-sm-2">
            @Html.TextBoxFor(x => x.EWB_EwayNo, new { @disabled = "disabled", @class = "form-control", @style = "width:100%;", @Value = Model.EWB_EwayNo, @Name = "CAN_EwayNo", @Id = "CAN_EwayNo" })
        </div>
        <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Reason:<span style="color:red;">*</span></label>
        <div class="col-sm-2">
            @Html.DropDownListFor(m => m.EWB_CancelReasonCode, DropdownHelper.EmptyList(), new { @class = "form-control", @Name = "CAN_CancelReasonCode", @Id = "CAN_CancelReasonCode" })
        </div>
    </div>
    <div class="col-sm-12" style="padding-bottom: 5px!important;">
        <label class="col-sm-1 control-label" style="color:black;font-weight:bold;">Remark:</label>
        <div class="col-sm-11">
            @Html.TextAreaFor(x => x.EWB_CancelReasonRemark, new { @class = "form-control", @Value = Model.EWB_CancelReasonRemark, @rows = "1", @maxlength = 100, @Name = "CAN_CancelReasonRemark", @Id = "CAN_CancelReasonRemark" })
        </div>
    </div>
    <div class="col-sm-12" style="padding-bottom: 5px!important;">
        <div class="col-sm-2">
            <button class="btn btn-success" style="color:black;font-size: 13px;padding:3px 12px;" id="btnCanEway">Cancel EwayBill</button>
        </div>
    </div>
</div>