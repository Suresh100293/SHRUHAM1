@model ALT_ERP3.Areas.Logistics.Models.ChangeCompanyDetailsVM
@using Common

<script>

    $(document).ready(function () {


        if ('@Model.TfatComp_VehicleList' != "") {
            $.each('@Model.TfatComp_VehicleList'.split(','), function (idx, val) {
                $(".TfatComp_VehicleListL option[value='" + val + "']").attr("selected", true);
            });
        }


        $("#btnactivateLRDetails").click(function (event) {
            $("#TfatComp_VehicleTrackURL,#TfatComp_VehicleTrackUserNameWithValue,#TfatComp_VehicleTrackPasswordithValue,#TfatComp_VehicleTrackPara1,#TfatComp_VehicleTrackPara2,#TfatComp_VehicleTrackPara3,#TfatComp_VehicleTrackPara4,#TfatComp_VehicleTrackPara5").prop('disabled', false);
            $("#btnaddLRDetails").show();
            $("#EditSaveLRLedger").hide();
        });
        //$("#btnactivateLRDetails").focusout(function (event) {
        //    $("#txtLRNumber").prop('disabled', false);
        //    $("#txtLRAmt").prop('disabled', false);
        //    $("#btnaddLRDetails").show();
        //    $("#EditSaveLRLedger").hide();
        //});

        $('button[action|="DeleteLRLedger"]').click(function (event) {
            event.preventDefault(event);
            var ModelData = {};
            ModelData["tempId"] = $(this).val();
           var DTO = { Model: ModelData };
            var url = '@Url.Action("DeleteLRDetails")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    $('#LRDetailsDialog').html(data.Html);
                },
                error: function () {
                    alert("Error occured while processing your request.");
                }
            });
        });

        $('button[action|="EditLRLedger"]').click(function (event) {
            event.preventDefault(event);
            
            var ModelData = {};
            ModelData["tempId"] = $(this).val();
            ModelData["SessionFlag"] = "Edit";

            var DTO = { Model: ModelData };
            var url = '@Url.Action("GetLRDetails")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    $('#LRDetailsDialog').html(data.Html);
                    $("#btnactivateLRDetails").hide();
                    $('#EditSaveLRLedger').show();
                    $("#TfatComp_VehicleTrackURL,#TfatComp_VehicleTrackUserNameWithValue,#TfatComp_VehicleTrackPasswordithValue,#TfatComp_VehicleTrackPara1,#TfatComp_VehicleTrackPara2,#TfatComp_VehicleTrackPara3,#TfatComp_VehicleTrackPara4,#TfatComp_VehicleTrackPara5").prop('disabled', false);
                },
                error: function (err) {
                    alert(JSON.stringify(err))
                    alert("Error occured while processing your request.");
                }
            });
        });

        $("#btnaddLRDetails").click(function (event) {
            event.preventDefault();
            var ModelData = {};
            ModelData["SessionFlag"] ="Add";
            ModelData["TfatComp_VehicleTrackURL"] = $("#TfatComp_VehicleTrackURL").val();
            ModelData["TfatComp_VehicleTrackUserNameWithValue"] = $("#TfatComp_VehicleTrackUserNameWithValue").val();
            ModelData["TfatComp_VehicleTrackPasswordithValue"] = $("#TfatComp_VehicleTrackPasswordithValue").val();
            ModelData["TfatComp_VehicleTrackPara1"] = $("#TfatComp_VehicleTrackPara1").val();
            ModelData["TfatComp_VehicleTrackPara2"] = $("#TfatComp_VehicleTrackPara2").val();
            ModelData["TfatComp_VehicleTrackPara3"] = $("#TfatComp_VehicleTrackPara3").val();
            ModelData["TfatComp_VehicleTrackPara4"] = $("#TfatComp_VehicleTrackPara4").val();
            ModelData["TfatComp_VehicleTrackPara5"] = $("#TfatComp_VehicleTrackPara5").val();

            var selected = "";
            $(".TfatComp_VehicleListL :selected").each(function () {
                selected += ("" + $(this).val() + ",");
            });
            selected = selected.toString().substring(0, selected.length - 1);
            ModelData["TfatComp_VehicleList"] = selected;

            var DTO = { Model: ModelData };
            var url = '@Url.Action("AddLRDetails")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data)
                {
                    if (data.Status == "ConfirmError") {
                        $('.spinner').hide();
                        alert(data.Message)
                        return;
                    }
                    else
                    {
                        $('.spinner').hide();
                        $('#LRDetailsDialog').html(data.Html);
                    }
                    
                },
                error: function () {
                    alert("Error occured while processing your request.");
                }
            });

        });

        $("#EditSaveLRLedger").click(function (event) {
            event.preventDefault();
            
            var ModelData = {};
            ModelData["SessionFlag"] = "Edit";
            ModelData["tempId"] = $("#hdnLRtempid").val();

            ModelData["TfatComp_VehicleTrackURL"] = $("#TfatComp_VehicleTrackURL").val();
            ModelData["TfatComp_VehicleTrackUserNameWithValue"] = $("#TfatComp_VehicleTrackUserNameWithValue").val();
            ModelData["TfatComp_VehicleTrackPasswordithValue"] = $("#TfatComp_VehicleTrackPasswordithValue").val();
            ModelData["TfatComp_VehicleTrackPara1"] = $("#TfatComp_VehicleTrackPara1").val();
            ModelData["TfatComp_VehicleTrackPara2"] = $("#TfatComp_VehicleTrackPara2").val();
            ModelData["TfatComp_VehicleTrackPara3"] = $("#TfatComp_VehicleTrackPara3").val();
            ModelData["TfatComp_VehicleTrackPara4"] = $("#TfatComp_VehicleTrackPara4").val();
            ModelData["TfatComp_VehicleTrackPara5"] = $("#TfatComp_VehicleTrackPara5").val();

            var selected = "";
            $(".TfatComp_VehicleListL :selected").each(function () {
                selected += ("" + $(this).val() + ",");
            });
            selected = selected.toString().substring(0, selected.length - 1);
            ModelData["TfatComp_VehicleList"] = selected;

            var DTO = { Model: ModelData };
            var url = '@Url.Action("AddLRDetails")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    if (data.Status == "ConfirmError") {
                        $('.spinner').hide();
                        alert(data.Message)
                        return;
                    }
                    else {
                        $('.spinner').hide();
                        $('#LRDetailsDialog').html(data.Html);
                    }
                },
                error: function () {
                    alert("Error occured while processing your request.");
                }
            });

        });
        $('.TfatComp_VehicleListL').multiselect({
            includeSelectAllOption: true,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            filterPlaceholder: 'Search for something...',
            buttonWidth: '150',
            numberDisplayed: 1,
            nonSelectedText: 'Select Vehicle No',
        })
    });
</script>

<div class="form-horizontal" id="ledgerupdate" style="margin-left:0px;">
    <div class="col-sm-12" id="SelectedLRTable">
        <table id="lrtabledata" class="zui-table" style="width:100%;word-wrap:break-word">
            <thead>
                <tr>
                    <td style="width:8%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;"></td>
                    <td style="width:1%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Sr.
                    </td>
                    <td style="width:40%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        API
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        User 
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Pass 
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Para1
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Para2
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Para3
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Para4
                    </td>
                    <td style="width:7%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Para5
                    </td>
                    <td style="width:10%;border-right: solid 1px dimgray;border-bottom: solid 1px dimgray;color:black;">
                        Vehicle
                    </td>

                    <td style="width:1%"></td>
                </tr>
                <tr role="row" style="font-family:Tahoma;font-size:9pt;width: 100%;">
                    <td style="width:8%">
                        <button type="button" class="btn btn-success" id="btnactivateLRDetails">Add</button>
                    </td>
                    <td style="width:1%">
                        @Html.TextBoxFor(x => x.tempId, new { @class = "form-control", @id = "hdnLRtempid", @Name = "hdnLRtempid", @Value = Model.tempId, @style = "text-align:right;display:none" })
                    </td>
                    <td style="width: 40%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackURL, new { @class = "form-control", @id = "TfatComp_VehicleTrackURL", @Name = "TfatComp_VehicleTrackURL", @Value = Model.TfatComp_VehicleTrackURL, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackUserNameWithValue, new { @class = "form-control", @id = "TfatComp_VehicleTrackUserNameWithValue", @Name = "TfatComp_VehicleTrackUserNameWithValue", @Value = Model.TfatComp_VehicleTrackUserNameWithValue, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPasswordithValue, new { @class = "form-control", @id = "TfatComp_VehicleTrackPasswordithValue", @Name = "TfatComp_VehicleTrackPasswordithValue", @Value = Model.TfatComp_VehicleTrackPasswordithValue, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPara1, new { @class = "form-control", @id = "TfatComp_VehicleTrackPara1", @Name = "TfatComp_VehicleTrackPara1", @Value = Model.TfatComp_VehicleTrackPara1, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPara2, new { @class = "form-control", @id = "TfatComp_VehicleTrackPara2", @Name = "TfatComp_VehicleTrackPara2", @Value = Model.TfatComp_VehicleTrackPara2, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPara3, new { @class = "form-control", @id = "TfatComp_VehicleTrackPara3", @Name = "TfatComp_VehicleTrackPara3", @Value = Model.TfatComp_VehicleTrackPara3, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPara4, new { @class = "form-control", @id = "TfatComp_VehicleTrackPara4", @Name = "TfatComp_VehicleTrackPara4", @Value = Model.TfatComp_VehicleTrackPara4, @disabled = "disabled" })
                    </td>
                    <td style="width: 7%">
                        @Html.TextBoxFor(x => x.TfatComp_VehicleTrackPara5, new { @class = "form-control", @id = "TfatComp_VehicleTrackPara5", @Name = "TfatComp_VehicleTrackPara5", @Value = Model.TfatComp_VehicleTrackPara5, @disabled = "disabled" })
                    </td>
                    <td style="width: 10%">
                        @Html.ListBoxFor(x => x.TfatComp_VehicleListL, Model.VehicleList, new { @class = "TfatComp_VehicleListL", @id = "TfatComp_VehicleListL" })
                    </td>
                    <td style="width:1%">
                        <button type="button" class="btn btn-success" id="btnaddLRDetails" style="display:none"><i class="fa fa-save"></i></button>
                        <button type="button" id="EditSaveLRLedger" class="btn btn-warning" title="EditSave" style="display:none"><i class="fa fa-save"></i></button>
                    </td>
                </tr>
            </thead>
            <tbody>
                @if (Model.VehicleTrackinglist != null)
                {
                    foreach (var item in @Model.VehicleTrackinglist.ToList())
                    {
                        <tr style="font-family:Tahoma;font-size:9pt;">
                            <td style="vertical-align:inherit;width:8%;">
                                <button type="button" action="EditLRLedger" class="btn btn-warning btn-sm" value="@item.tempId" title="Edit"><i class="fa fa-edit"></i></button>
                                <button type="button" action="DeleteLRLedger" class="btn btn-danger btn-sm" value="@item.tempId" title="Delete"><i class="fa fa-trash-o"></i></button>
                            </td>
                            <td style="vertical-align:inherit;width:1%;">@item.tempId</td>
                            <td style="vertical-align:inherit;width:40%">@item.TfatComp_VehicleTrackURL</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackUserNameWithValue</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPasswordithValue</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPara1</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPara2</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPara3</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPara4</td>
                            <td style="vertical-align:inherit;width:7%">@item.TfatComp_VehicleTrackPara5</td>
                            <td style="vertical-align:inherit;width:10%">@item.TfatComp_VehicleList</td>
                            <td style="width:1%"></td>
                        </tr>
                    }
                }
            </tbody>

        </table>
    </div>


</div>