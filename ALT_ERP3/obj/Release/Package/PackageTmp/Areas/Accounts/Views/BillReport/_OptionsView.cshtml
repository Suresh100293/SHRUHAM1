
@model ALT_ERP3.Areas.Accounts.Models.BillReportVM

<style>
    .ModalLabel {
        font-weight: bold !important;
        color: black !important;
        padding: 3px !important;
    }

    

    .multiselect-container {
        width: 215px !important;
    }

    

    .td1 {
        width: 500px !important;
    }

    .td2 {
        width: 500px !important;
    }

    .td3 {
        width: 500px !important;
    }

    
</style>
<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>
<link href="~/Content/bootstrap-multiselect.css" rel="stylesheet" />
<script src="~/Content/bootstrap-multiselect.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        @*$('#Fromdate').val('@Model.FromDate');
        $('#ToDate').val('@Model.ToDate');*@

        if ('@Model.BillType' != "")
        {
            $("#BillType").val('@Model.BillType');
        }
        else
        {
            $("#BillType").val("SLR00");
        }

        $("#txtBillNo").val("");
        if ('@Model.BillNo' != "")
        {
            $("#txtBillNo").val('@Model.BillNo');
        }

        $("#txtReportName").val("");
        if ('@Model.ReportName' != "") {
            $("#txtReportName").val('@Model.ReportName');
        }

        $("#FormatCode").val("");
        if ('@Model.ReportTypeL' != "") {
            $("#FormatCode").val('@Model.ReportTypeL');
            $("#ReportTypeL").val('@Model.ReportTypeL');
            $("#Ledger").html($(".ReportTypeL option:selected").text());
            if ('@Model.ReportTypeL' == "BillReport") {
                $('.chkPaymentReceivedDetails').prop('disabled', false);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', false);
                $('.chkBillSubMissionDetails').prop('disabled', false);
            }
            else {
                $('.chkPaymentReceivedDetails').prop('disabled', true);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', true);
                $('.chkBillSubMissionDetails').prop('disabled', true);
            }
        }
        debugger;
        $('#Branch').val('');
        var CommonValue = "";
        if ('@Model.Branch' != "") {
            $.each('@Model.Branch'.split(','), function (idx, val) {
                $(".BranchL option[value='" + val + "']").attr("selected", true);
                CommonValue +=  val + ",";
            });
            CommonValue = CommonValue.toString().substring(0, CommonValue.length - 1);
            $('#Branch').val(CommonValue);
        }

        $("#CustomerReq").val(false);
        if ('@Model.CustomerReq'=="True" || '@Model.CustomerReq'=="true") {
            $("#CustomerReq").val(true);
            $("#CustomerFF").prop("checked", true);
            $("#MasterF").prop("checked", false);
            $('.CustomerDiv').removeClass("hidden");
            $('.MasterDiv').addClass("hidden");
        }
        else
        {
            $("#CustomerFF").prop("checked", false);
            $("#MasterF").prop("checked", true);
            $('.CustomerDiv').addClass("hidden");
            $('.MasterDiv').removeClass("hidden");
        }



        $('#Customer').val('');
        if ('@Model.CustomerReq' == "True" || '@Model.CustomerReq' == "true")
        {
            CommonValue = "";
            if ('@Model.Customer' != "") {
                $.each('@Model.Customer'.split(','), function (idx, val) {
                    $(".CustomerL option[value='" + val + "']").attr("selected", true);
                    CommonValue +=  val + ",";
                });
                CommonValue = CommonValue.toString().substring(0, CommonValue.length - 1);
                $('#Customer').val(CommonValue);
            }
        }
        else
        {
            CommonValue = "";
            if ('@Model.Customer' != "") {
                $.each('@Model.Customer'.split(','), function (idx, val) {
                    $(".MasterL option[value='" + val + "']").attr("selected", true);
                    CommonValue +=  val + ",";
                });
                CommonValue = CommonValue.toString().substring(0, CommonValue.length - 1);
                $('#Customer').val(CommonValue);
            }
        }
        $("#BillSubMissionDetails").val(false);
        if ('@Model.BillSubMissionDetails'=="True" || '@Model.BillSubMissionDetails'=="true") {
            $("#BillSubMissionDetails").val(true);
            $(".chkBillSubMissionDetails").prop("checked", true);
        }

        $('.chkPaymentReceDetailsChargesReq').prop('disabled', true);
        $("#PaymentReceivedDetails").val(false);
        if ('@Model.PaymentReceivedDetails'=="True" || '@Model.PaymentReceivedDetails'=="true") {
            $("#PaymentReceivedDetails").val(true);
            $(".chkPaymentReceivedDetails").prop("checked", true);
            $(".chkPaymentReceDetailsChargesReq").prop("disabled", false);
        }

        $("#PaymentReceDetailsChargesReq").val(false);
        if ('@Model.PaymentReceDetailsChargesReq'=="True" || '@Model.PaymentReceDetailsChargesReq'=="true") {
            $("#PaymentReceDetailsChargesReq").val(true);
            $(".chkPaymentReceDetailsChargesReq").prop("checked", true);
        }

        $(".BillTypes").change(function () {
            $("#BillType").val(this.value);
        });
        $(".ReportTypeL").change(function () {
            debugger;
            $("#FormatCode").val(this.value);
            $("#Ledger").html($(".ReportTypeL option:selected").text());
            $("#PaymentReceivedDetails").val(false);
            $("#PaymentReceDetailsChargesReq").val(false);
            $("#BillSubMissionDetails").val(false);
            if (this.value =="BillReport")
            {
                $('.chkPaymentReceivedDetails').prop("checked", false);
                $('.chkPaymentReceivedDetails').prop('disabled', false);

                $('.chkPaymentReceDetailsChargesReq').prop("checked", false);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', true);

                $('.chkBillSubMissionDetails').prop("checked", false);
                $('.chkBillSubMissionDetails').prop('disabled', false);
            }
            else
            {
                $('.chkPaymentReceivedDetails').prop("checked", false);
                $('.chkPaymentReceivedDetails').prop('disabled', true);

                $('.chkPaymentReceDetailsChargesReq').prop("checked", false);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', true);

                $('.chkBillSubMissionDetails').prop("checked", false);
                $('.chkBillSubMissionDetails').prop('disabled', true);

                //if (this.value == "UnSubmissionBill")
                //{
                //    $("#BillSubMissionDetails").val(true);
                //}
            }

            ChangeFormatCoumnsList();
        });

        $(".BranchL").change(function () {
            debugger;
            $('#Branch').val('');
            var selected = "";
            $(".BranchL :selected").each(function () {
                selected += ("" + $(this).val() + ",");
            });
            selected = selected.toString().substring(0, selected.length - 1);
            $('#Branch').val(selected)
            return false;
        });
        $("input[name$='AccountType']").change(function () {
            debugger;
            var GetChrgesName = this.value;
            if (GetChrgesName == "CustomerFF") {
                $('.CustomerDiv').removeClass("hidden");
                $('.MasterDiv').addClass("hidden");
                $("#CustomerReq").val(true);
                $(".CustomerL").trigger("change");
            }
            else if (GetChrgesName == "MasterF") {
                $('.CustomerDiv').addClass("hidden");
                $('.MasterDiv').removeClass("hidden");
                $("#CustomerReq").val(false);
                $(".MasterL").trigger("change");
            }
        });
        $(".CustomerL").change(function () {

            $('#Customer').val('');
            var selected = "";
            $(".CustomerL :selected").each(function () {
                selected += ("" + $(this).val() + ",");
            });
            selected = selected.toString().substring(0, selected.length - 1);
            $('#Customer').val(selected)
            return false;
        });

        $(".MasterL").change(function () {

            $('#Customer').val('');
            var selected = "";
            $(".MasterL :selected").each(function () {
                selected += ("" + $(this).val() + ",");
            });
            selected = selected.toString().substring(0, selected.length - 1);
            $('#Customer').val(selected)
            return false;
        });


        $(".chkPaymentReceivedDetails").change(function () {
            if (this.checked) {
                $('#PaymentReceivedDetails').val(true);
                $('#PaymentReceDetailsChargesReq').val(false);
                $('.chkPaymentReceDetailsChargesReq').prop("checked", false);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', false);
                PaymentReceivedCoumnsList(true, $("#ReportTypeL").val());
            } else {
                $('#PaymentReceivedDetails').val(false);
                $('#PaymentReceDetailsChargesReq').val(false);
                $('.chkPaymentReceDetailsChargesReq').prop("checked", false);
                $('.chkPaymentReceDetailsChargesReq').prop('disabled', true);
                PaymentReceivedCoumnsList(false, $("#ReportTypeL").val());
            }

        });
        $(".chkPaymentReceDetailsChargesReq").change(function () {
            if (this.checked) {
                $('#PaymentReceDetailsChargesReq').val(true);
                PaymentReceivedChargesCoumnsList(true, $("#ReportTypeL").val());
            } else {
                $('#PaymentReceDetailsChargesReq').val(false);
                PaymentReceivedChargesCoumnsList(false, $("#ReportTypeL").val());
            }
        });
        $(".chkBillSubMissionDetails").change(function () {
            if (this.checked) {
                $('#BillSubMissionDetails').val(true);
                BillSubmissionCoumnsList(true, $("#ReportTypeL").val());
            } else {
                $('#BillSubMissionDetails').val(false);
                BillSubmissionCoumnsList(false, $("#ReportTypeL").val());
            }
        });
        $('#SubmitSaveReport').click(function (event) {
            event.preventDefault();
            $('#SaveReportName').modal('show');
        });
        $('#btnopnFormat').click(function(event){
            event.preventDefault();
            var ModelData = {};
            ModelData["ViewDataId"] = $("#FormatCode").val();
            var DTO = { Model: ModelData };
            var url = '@Url.Action("GetReportFormat")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $("#ErrorMessage").hide();
                    $('.spinner').hide();
                    $('#updTfatsearch').modal('show');
                    $('#updTfatsearchDiv').html(data.Html);
                },
                error: function () {
                    alert("Error occured while processing your request.");
                }
            });
        });

        $('.BranchL,.CustomerL,.MasterL').multiselect({
            includeSelectAllOption: true,
            enableFiltering: true,
            enableCaseInsensitiveFiltering: true,
            filterPlaceholder: 'Search for something...',
            buttonWidth: '235',
            numberDisplayed: 1,
            nonSelectedText: 'Select Item',
        })
    });
</script>
<table class="table table-striped table-bordered">
    <thead>
    </thead>
    <tbody>
        <tr>
            <td class="td1">
                <label class=" ModalLabel  control-label" style="width:auto;">Bill Type :</label>
                @Html.DropDownListFor(x => x.BillType, Model.BillTypes, new { @class = "form-control BillTypes", @style = "float: right;width:auto;display: inline-table;" })
            </td>
            <td class="td2">
                <label class=" ModalLabel  control-label" style="width:auto;">Bill No :</label>
                @Html.TextBoxFor(x => x.BillNo, new { @class = "form-control txtBillNo", @id = "txtBillNo", @style = "width:100px;display: inline-table;float: initial;" })
            </td>
            <td class="td3">
                <label class=" ModalLabel  control-label" style="width:auto;">Report Type :</label>
                @Html.DropDownListFor(x => x.ReportTypeL, Model.ReportsType, new { @class = "form-control ReportTypeL", @style = "float: right;width:163px;display: inline-table;" })
            </td>
        </tr>
        <tr>
            <td class="td1">
                <label class=" ModalLabel  control-label" style="width:auto;"> Branch :</label>
                @Html.ListBoxFor(x => x.BranchL, Model.BranchesOnly, new { @class = "BranchL", @id = "BranchL" })
            </td>
            <td class="td2">
                <label class=" ModalLabel  control-label" style="width:auto;">Acc. Type :</label>
                <div style="display:flex;float:right;">
                    <input type="radio" class="form-control " name="AccountType" id="CustomerFF" value="CustomerFF" style="height:20px;width:35px;" /><label class=" bold control-label" style="color:black;padding: 3px 0px 0px 0px;"> Customer</label>
                    <input type="radio" class="form-control " name="AccountType" id="MasterF" value="MasterF" style="height:20px;width:35px;" /><label class=" bold control-label" style="color:black;padding: 3px 0px 0px 0px;"> Master</label>
                </div>
            </td>
            <td class="td3">
                <div id="CustomerDiv" class="CustomerDiv">
                    <label class=" ModalLabel  control-label" style="width:auto;">Customer :</label>
                    @Html.ListBoxFor(x => x.CustomerL, Model.Customers, new { @class = "CustomerL", @id = "CustomerL" })
                </div>
                <div id="MasterDiv" class="MasterDiv hidden">
                    <label class=" ModalLabel  control-label" style="width:auto;">Master :</label>
                    @Html.ListBoxFor(x => x.MasterL, Model.Masters, new { @class = "MasterL", @id = "MasterL" })
                </div>
            </td>
        </tr>
        <tr>
            <td class="td1">
                <label class=" ModalLabel  control-label" style="width:auto;">Bill-SubMission-Details :</label>
                <div style="display:flex;float:right;">
                    <input type="checkbox" class="form-control chkBillSubMissionDetails" id="BillSubMissionDetails" value="BillSubMissionDetails" style="height:20px;width:35px;" />
                </div>
            </td>
            <td class="td2">
                <label class=" ModalLabel  control-label" style="width:auto;">Show Payment Received :</label>
                <div style="display:flex;float:right;">
                    <input type="checkbox" class="form-control chkPaymentReceivedDetails" id="PaymentReceivedDetails" value="PaymentReceivedDetails" style="height:20px;width:35px;" />
                </div>
            </td>
            <td class="td3">
                <label class=" ModalLabel  control-label" style="width:auto;">Payment Received(Charges):</label>
                <div style="display:flex;float:right;">
                    <input type="checkbox" class="form-control chkPaymentReceDetailsChargesReq" id="PaymentReceDetailsChargesReq" value="PaymentReceDetailsChargesReq" style="height:20px;width:35px;" />
                </div>
            </td>
        </tr>
    </tbody>
</table>