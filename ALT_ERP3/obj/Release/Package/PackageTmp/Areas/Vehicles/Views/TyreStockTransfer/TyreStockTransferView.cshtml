@model ALT_ERP3.Areas.Vehicles.Models.TyreStockTransferVM
@using Common;
@{
    ViewBag.Title = "TyreStockTransfer Master";
    Layout = null;
}

<link href="~/Content/ToogleCreate/CreateTgl.css" rel="stylesheet" />
<script src="~/Content/ToogleCreate/CreateTgl.js"></script>
<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
        loadStockList();
        loadRealtedChoice();
        if ('@Model.Mode' == "Add") {
            $("#FourthTab").addClass("hidden");
            $('#StockID').prop('disabled', false);
        }
        else
        {
            $('#StockID').prop('disabled', true);
            if ('@Model.TransferToStock' == "New")
            {
                $("#FourthTab").removeClass("hidden");
                $("#StockStatusList").prop("disabled", true);
                $("#PickData").prop("disabled", true);
                $("#FirstTab").addClass("hidden");
                $("#SecondTab").addClass("hidden");
                $("#ThirdTab").addClass("hidden");
                document.getElementById("FourthTab").click();
            }
            else
            {
                $("#FourthTab").addClass("hidden");
                $("#StockStatusList").prop("disabled", false);
                $("#PickData").prop("disabled", false);
                $("#FirstTab").removeClass("hidden");
                $("#SecondTab").removeClass("hidden");
                $("#ThirdTab").removeClass("hidden");
                document.getElementById("FirstTab").click();
            }
        }
        $("#VehicleList").prop("disabled", true);
        $("#TyrePlaceNo,#InstallKM").constrain({ allow: { regex: "[0-9]" } });
        if ('@Model.OldStkStatus' == "" || '@Model.OldStkStatus' == null) {
            $('#TransferDetailsDiv :input').prop('disabled', true);
        } else {
            $('#TransferDetailsDiv :input').prop('disabled', false);
        }
        if ('@Model.Mode'=="Delete" || '@Model.Mode'=="View" || '@Model.blockDocument'=="True" || '@Model.PreviousVehicleblockDocument' == "True") {
            $('#StockDetails :input').prop('disabled', true);
            $('#TransferDetails :input').prop('disabled', true);
            $('#VehicleList').prop('disabled', true);

        }
        if ('@Model.blockDocument' == "True" || '@Model.NStockblockDocument'=="True")
            {
                $("#ErrorMessage").show();
                $("#ErrorMessage").html("This Document Lock Because Of This Stock Transferd.....");
                $('#Submit,#btnDelete').prop('disabled', true);
            }
            if ('@Model.PreviousVehicleblockDocument' == "True" || '@Model.NPreviousblockDocument'=="True")
            {
                $("#ErrorMessage").show();
                $("#ErrorMessage").html("This Document Lock Because Of This Old Vehicle Stock Transferd.....");
                $('#Submit,#btnDelete').prop('disabled', true);
            }
        $("#StockID").change(function () {
            $("#ErrorMessage").hide();
            if (this.checked) {
                $("#FourthTab").removeClass("hidden");
                $("#StockStatusList").prop("disabled", true);
                $("#PickData").prop("disabled", true);
                $("#FirstTab").addClass("hidden");
                $("#SecondTab").addClass("hidden");
                $("#ThirdTab").addClass("hidden");
                document.getElementById("FourthTab").click();

            }
            else {
                $("#FourthTab").addClass("hidden");
                $("#StockStatusList").prop("disabled",false);
                $("#PickData").prop("disabled",false);
                $("#FirstTab").removeClass("hidden");
                $("#SecondTab").removeClass("hidden");
                $("#ThirdTab").removeClass("hidden");
                document.getElementById("FirstTab").click();

            }
        });


        $("#PickData").click(function () {
            if ($("#StockStatusList").val() == "0") {
                alert("Please Select Stock List.........!");
                return;
            }
            var ModelData = {};
            ModelData["StockStatusList"] = $("#StockStatusList").val();

            var DTO = { Model: ModelData };
            var url = '@Url.Action("GetPickUp")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $("#ErrorMessage").hide();
                    $('.spinner').hide();
                    $('#pickuplist').modal('show');
                    $('#PickUpList').html(data.Html);
                },
                error: function () {
                    alert("Error occured while processing your request.");
                }
            });

        });
        $("#Submit").click(function () {

            debugger;
            var ModelData = {};
            if ($("#NewStockDetails").is(":visible")) {
                var mValidate = '';


                if ($("#RelatedChoice").is(":visible")) {
                    if ($("#RelatedChoice").val() == "" || $("#RelatedChoice").val() == null || $("#RelatedChoice").val() == "0") {
                        alert("Please Select Vehicle No....!");
                        return;
                    }
                }

                var StockRemould = true;
                if ($("#RelatedChoice").val() == "Stock") {
                    StockRemould = false;
                }
                var Message = "";
                $('#truckrelatedtable tbody tr').each(function () {
                    debugger;
                    var tds = $(this).find('td');

                    if (tds.eq(0).text() == "F002") {
                        if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || tds.find(".addontxtfvalue").val() == "Select") {
                            mValidate = 'Y';
                            Message += "Product Required....!\n";
                        }
                    }

                    if (tds.eq(0).text() == "F003") {
                        if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                            mValidate = 'Y';
                            Message += "Cost Required....!\n";
                        }
                    }
                    if (tds.eq(0).text() == "F014") {
                        if (tds.find(".addontxtfvalue").val() == "Select") {
                            mValidate = 'Y';
                            Message += "Tyre Type Required....!\n";
                        }
                    }

                    if (tds.eq(0).text() == "F004") {
                        if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                            mValidate = 'Y';
                            Message += "Warranty KM Required....!\n";
                        }
                    }

                    if (tds.eq(0).text() == "F005") {
                        if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                            mValidate = 'Y';
                            Message += "Warranty Days Required....!\n";
                        }
                    }
                    debugger;
                    if (StockRemould) {
                        if (tds.eq(0).text() == "F006") {
                            //if (tds.find(".addontxtfvalue:checked").val() == "" || tds.find(".addontxtfvalue").val() == null) {
                            if (tds.find('input[name="addontxtfvalue"]:checked').val() == "" || tds.find('input[name="addontxtfvalue"]:checked').val() == null) {
                                mValidate = 'Y';
                                Message += "Please Select Install For Option....!\n";
                            }
                        }

                        if (tds.eq(0).text() == "F007") {
                            if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                                mValidate = 'Y';
                                Message += "Tyre Placed No Required....!\n";
                            }
                        }
                    }

                    if (tds.eq(0).text() == "F008") {
                        if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null) {
                            mValidate = 'Y';
                            Message += "Tyre SerialNo Required....!\n";
                        }
                    }
                    if (StockRemould) {
                        if (tds.eq(0).text() == "F011") {
                            if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                                mValidate = 'Y';
                                Message += "Install KM Required....!\n";
                            }
                        }
                        if (tds.eq(0).text() == "F013") {
                            if (tds.find(".addontxtfvalue").val() == "" || tds.find(".addontxtfvalue").val() == null || parseFloat(tds.find(".addontxtfvalue").val()) < 0) {
                                mValidate = 'Y';
                                Message += "Expiry KM Required....!\n";
                            }
                        }
                    }
                })
                if (mValidate == 'Y' && Message != "") {
                    alert(Message);
                    return;
                }
                //AddON Details Save
                var rlarray = [];
                $('#truckrelatedtable tbody tr').each(function () {

                    var tds = $(this).find('td');
                    var ApplyCode = "";
                    if ( tds.eq(0).text() == "F006") {
                        ApplyCode = $("input[class=addontxtfvalue]:checked").val();
                    }
                    else {
                        ApplyCode = tds.find(".addontxtfvalue").val();
                    }
                    var myDets2 = {
                        Fld: tds.eq(0).text(),
                        Head: tds.eq(1).text(),
                        ApplCode: ApplyCode,
                        FldType: tds.eq(3).text(),
                    }
                    rlarray.push(myDets2);
                })
                ModelData["AddOnList"] = rlarray;

                ModelData["Document"] = $("#Document").val();

                //Tyre Stock Details Save
                ModelData["RelatedChoice"] = $("#RelatedChoice").val();
                ModelData["RelatedChoice"] = $("#RelatedChoice").val();
                ModelData["NPreviousTransferToStock"] = $("#NPreviousTransferToStock").val();
                ModelData["NPreviousStockSerial"] = $("#NPreviousStockSerial").val();
                ModelData["NPreviousInstallDate"] = $("#NPreviousInstallDate").val();
                ModelData["NPreviousInstallKM"] = $("#NPreviousInstallKM").val();
                ModelData["NPreviousExpirtDate"] = $("#NPreviousExpirtDate").val();
                ModelData["NPreviousExpiryKM"] = $("#NPreviousExpiryKM").val();
                ModelData["NPreviousStockAt"] = $("#NPreviousStockAt").val();
                ModelData["NPreviousIsActive"] = $("#NPreviousIsActive").val();
                ModelData["NPreviousTablekey"] = $("#NPreviousTablekey").val();
                ModelData["NPreviousBranch"] = $("#NPreviousBranch").val();
            }
            else {
                if ($("#TransferToStock").val() == "0") {
                    $("#ErrorMessage").show();
                    $("#ErrorMessage").text(' Transfer To Required......');
                    return;
                }
                if ($("#TransferToStock").val() == "Vehicle") {
                    if ($("#VehicleList").val() == "0") {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Vehicle No Required......');
                        return;
                    }
                    if ($("#InstallFor").val() == "0") {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Install For Required......');
                        return;
                    }
                    if ($("#TyrePlaceNo").val() == "0" || $("#TyrePlaceNo").val() == null) {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Place No Required......');
                        return;
                    }
                    if ($("#InstallDate").val() == "" || $("#InstallDate").val() == null) {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Install Date Required......');
                        return;
                    }

                    if ($("#InstallKM").val() == "" || $("#InstallKM").val() == null) {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Install KM Required......');
                        return;
                    }
                    debugger;
                    if ($("#PreviousVehicleStatusStockSerial").val() != null) {
                        if ($("#PreviousVehicleStatusTransferToStock").val() == "0" || $("#PreviousVehicleStatusTransferToStock").val() == null) {
                            $("#ErrorMessage").show();
                            $("#ErrorMessage").text('Previous Vehicle Status Required......');
                            return;
                        }
                    }
                }
                else {
                    if ($("#InstallDate1").val() == "" || $("#InstallDate1").val() == null) {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").text(' Install Date Required......');
                        return;
                    }
                }

                ModelData["Document"] = $("#Document").val();

                //Selected Stock Details
                ModelData["OldStkTyreSerialNo"] = $("#OldStkTyreSerialNo").val();
                ModelData["OldStkStatus"] = $("#OldStkStatus").val();
                ModelData["OldStkAt"] = $("#OldStkAt").val();
                ModelData["OldStkTyrePlcaseNo"] = $("#OldStkTyrePlcaseNo").val();
                ModelData["OldStkTypeName"] = $("#OldStkTypeName").val();
                ModelData["OldStkTypeNameCode"] = $("#OldStkTypeNameCode").val();
                ModelData["OldStkCost"] = $("#OldStkCost").val();
                ModelData["OldStkWarrantyKM"] = $("#OldStkWarrantyKM").val();
                ModelData["OldStkDays"] = $("#OldStkDays").val();
                ModelData["OldStkInstallFor"] = $("#OldStkInstallFor").val();
                ModelData["OldStkInstallDate"] = $("#OldStkInstallDate").val();
                ModelData["OldStkInstallKM"] = $("#OldStkInstallKM").val();
                ModelData["OldStkExpirtDate"] = $("#OldStkExpirtDate").val();
                ModelData["OldStkExpiryKM"] = $("#OldStkExpiryKM").val();
                ModelData["OldStkTablekey"] = $("#OldStkTablekey").val();
                ModelData["OldStkBranch"] = $("#OldStkBranch").val();

                //Current Stock Details
                ModelData["TransferToStock"] = $("#TransferToStock").val();
                ModelData["VehicleList"] = $("#VehicleList").val();
                ModelData["VehicleCode"] = $("#VehicleList").val();
                ModelData["InstallFor"] = $("#InstallFor").val();
                ModelData["TyrePlaceNo"] = $("#TyrePlaceNo").val();
                if ($("#TransferToStock").val() == "Vehicle") {
                    ModelData["TyreSerialNo"] = $("#TyreSerialNo").val();
                    ModelData["InstallDate"] = $("#InstallDate").val();
                }
                else {
                    ModelData["TyreSerialNo"] = $("#TyreSerialNo1").val();
                    ModelData["InstallDate"] = $("#InstallDate1").val();
                }
                ModelData["InstallKM"] = $("#InstallKM").val();

                //Previous Stock Details
                ModelData["PreviousVehicleStatusTransferToStock"] = $("#PreviousVehicleStatusTransferToStock").val();
                ModelData["PreviousVehicleStatusStockSerial"] = $("#PreviousVehicleStatusStockSerial").val();
                ModelData["PreviousVehicleStatusInstallDate"] = $("#PreviousVehicleStatusInstallDate").val();
                ModelData["PreviousVehicleStatusInstallKM"] = $("#PreviousVehicleStatusInstallKM").val();
                ModelData["PreviousVehicleStatusExpirtDate"] = $("#PreviousVehicleStatusExpirtDate").val();
                ModelData["PreviousVehicleStatusExpiryKM"] = $("#PreviousVehicleStatusExpiryKM").val();
                ModelData["PreviousVehicleStatusStockAt"] = $("#PreviousVehicleStatusStockAt").val();
                ModelData["PreviousVehicleStatusIsActive"] = $("#PreviousVehicleStatusIsActive").val();
                ModelData["PreviousVehicleStatusTablekey"] = $("#PreviousVehicleStatusTablekey").val();
                ModelData["PreviousVehicleStatusBranch"] = $("#PreviousVehicleStatusBranch").val();
            }




            ModelData["Mode"] = '@Model.Mode';
            ModelData["Header"] = '@Model.Header';
            var DTO = { Model: ModelData };
            var url = '@Url.Action("SaveData")';
            $.ajax({
                async: false,
                cache: false,
                url: url,
                data: JSON.stringify(DTO),
                type: "POST",
                dataType: "json",
                cache: false,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    if (data.Status == 'Success') {
                    $('.spinner').hide();
                        window.location.href = "/Vehicles/MasterGrid/Index?ViewDataId=@Model.ViewDataId&Module=@Model.Module&TableName=@Model.TableName&OptionType=@Model.OptionType&OptionCode=@Model.OptionCode&Header=@Model.Header&Controller2=@Model.Controller2&MainType=@Model.MainType";
                    $("#ErrorMessage").hide();
                }
                else {
                    $('.spinner').hide();
                    alert(data.Message);
                }
                },
            });
        });
        $("#btnDelete").click(function () {
            $('.spinner').show();
             var ModelData = {};
            ModelData["Document"] = $("#Document").val();

            //Selected Stock Details
            ModelData["OldStkTyreSerialNo"] = $("#OldStkTyreSerialNo").val();
            ModelData["OldStkStatus"] = $("#OldStkStatus").val();
            ModelData["OldStkAt"] = $("#OldStkAt").val();
            ModelData["OldStkTyrePlcaseNo"] = $("#OldStkTyrePlcaseNo").val();
            ModelData["OldStkTypeName"] = $("#OldStkTypeName").val();
            ModelData["OldStkTypeNameCode"] = $("#OldStkTypeNameCode").val();
            ModelData["OldStkCost"] = $("#OldStkCost").val();
            ModelData["OldStkWarrantyKM"] = $("#OldStkWarrantyKM").val();
            ModelData["OldStkDays"] = $("#OldStkDays").val();
            ModelData["OldStkInstallFor"] = $("#OldStkInstallFor").val();
            ModelData["OldStkInstallDate"] = $("#OldStkInstallDate").val();
            ModelData["OldStkInstallKM"] = $("#OldStkInstallKM").val();
            ModelData["OldStkExpirtDate"] = $("#OldStkExpirtDate").val();
            ModelData["OldStkExpiryKM"] = $("#OldStkExpiryKM").val();
            ModelData["OldStkTablekey"] = $("#OldStkTablekey").val();
            ModelData["OldStkBranch"] = $("#OldStkBranch").val();

            //Current Stock Details
            ModelData["TransferToStock"] = $("#TransferToStock").val();
            ModelData["VehicleList"] = $("#VehicleList").val();
            ModelData["VehicleCode"] = $("#VehicleList").val();
            ModelData["InstallFor"] = $("#InstallFor").val();
            ModelData["TyrePlaceNo"] = $("#TyrePlaceNo").val();
            if ($("#TransferToStock").val() == "Vehicle")
            {
                ModelData["TyreSerialNo"] = $("#TyreSerialNo").val();
                ModelData["InstallDate"] = $("#InstallDate").val();
            }
            else
            {
                ModelData["TyreSerialNo"] = $("#TyreSerialNo1").val();
                ModelData["InstallDate"] = $("#InstallDate1").val();
            }
            ModelData["InstallKM"] = $("#InstallKM").val();

            //Previous Stock Details
            ModelData["PreviousVehicleStatusTransferToStock"] = $("#PreviousVehicleStatusTransferToStock").val();
            ModelData["PreviousVehicleStatusStockSerial"] = $("#PreviousVehicleStatusStockSerial").val();
            ModelData["PreviousVehicleStatusInstallDate"] = $("#PreviousVehicleStatusInstallDate").val();
            ModelData["PreviousVehicleStatusInstallKM"] = $("#PreviousVehicleStatusInstallKM").val();
            ModelData["PreviousVehicleStatusExpirtDate"] = $("#PreviousVehicleStatusExpirtDate").val();
            ModelData["PreviousVehicleStatusExpiryKM"] = $("#PreviousVehicleStatusExpiryKM").val();
            ModelData["PreviousVehicleStatusStockAt"] = $("#PreviousVehicleStatusStockAt").val();
            ModelData["PreviousVehicleStatusIsActive"] = $("#PreviousVehicleStatusIsActive").val();
            ModelData["PreviousVehicleStatusTablekey"] = $("#PreviousVehicleStatusTablekey").val();
            ModelData["PreviousVehicleStatusBranch"] = $("#PreviousVehicleStatusBranch").val();

            ModelData["Mode"] = '@Model.Mode';
            ModelData["Header"] = '@Model.Header';
            var DTO = { Model: ModelData };
            var url = '@Url.Action("DeleteData")';
            $.ajax({
                async: false,
                cache: false,
                url: url,
                data: JSON.stringify(DTO),
                type: "POST",
                dataType: "json",
                cache: false,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    if (data.Status == 'Success') {
                    $('.spinner').hide();
                        window.location.href = "/Vehicles/MasterGrid/Index?ViewDataId=@Model.ViewDataId&Module=@Model.Module&TableName=@Model.TableName&OptionType=@Model.OptionType&OptionCode=@Model.OptionCode&Header=@Model.Header&Controller2=@Model.Controller2&MainType=@Model.MainType";
                    $("#ErrorMessage").hide();
                }
                else {
                    $('.spinner').hide();
                    alert(data.Message);
                }
                },
            });
        });


    });
    function History() {
        var ModelData = {};
        ModelData["OldStkTablekey"] = $("#OldStkTablekey").val();
        var DTO = { Model: ModelData };
        var url = '@Url.Action("HistoryDetails")';
        $.ajax({
            type: "POST",
            dataType: "json",
            data: JSON.stringify(DTO),
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            beforeSend: function () {
                $('.spinner').show();
            },
            success: function (data) {
                debugger;

                    $('#HistoryDetailsDiv').html('');
                    $('#HistoryDetailsDiv').html(data.Html);

                $("#ErrorMessage").hide();
                $('.spinner').hide();
            },
            error: function () {
                alert("Error occured while processing your request.");
            }
        });
    }
    function loadStockList()
    {
        var url = '@Url.Action("PopulateStock")';
        $.ajax({
            type: "GET",
            dataType: "json",
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            beforeSend: function () {

            },
            success: function (result)
            {
                $.each(result, function (i, item) {
                    $("#StockStatusList").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#StockStatusList').val('@Model.StockStatusList').attr("selected", "selected");
            },
            error: function ()
            {
                $('.spinner').hide();
                alert("An error occurred while processing the request.");
            }
        });
    };
    function loadRealtedChoice()
    {
        var url = '@Url.Action("PopulateVehicleNew")';
        $.ajax({
            type: "GET",
            dataType: "json",
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            beforeSend: function () {

            },
            success: function (result)
            {
                $.each(result, function (i, item) {
                    $("#RelatedChoice").append("<option value='" + item.Value + "'>" + item.Text + "</option>");
                });
                $('#RelatedChoice').val('@Model.RelatedChoice').attr("selected", "selected");
            },
            error: function ()
            {
                $('.spinner').hide();
                alert("An error occurred while processing the request.");
            }
        });
    };
    function getVehicleDetails() {
        if ($("#TransferToStock").val() != "Vehicle") {

            $("#InstallFor").val("0");
            $("#TyrePlaceNo").val("");
            $("#TyreSerialNo").val("");
            $("#InstallKM").val("");
            $("#VehicleList").val("0");
        }

        var ModelData = {};
        ModelData["TransferToStock"] = $("#TransferToStock").val();


        ModelData["VehicleList"] = $("#VehicleList").val();
        ModelData["InstallFor"] = $("#InstallFor").val();
        ModelData["TyrePlaceNo"] = $("#TyrePlaceNo").val();
        ModelData["TyreSerialNo"] = $("#TyreSerialNo").val();
        ModelData["InstallDate"] = $("#InstallDate").val();
        ModelData["InstallKM"] = $("#InstallKM").val();
        ModelData["OldStkStatus"] = $("#OldStkStatus").val();

        var DTO = { Model: ModelData };
        var url = '@Url.Action("NewStockDetails")';
        $.ajax({
            type: "POST",
            dataType: "json",
            data: JSON.stringify(DTO),
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            beforeSend: function () {
                $('.spinner').show();
            },
            success: function (data) {
                debugger;
                if (data.status =="Success") {
                    $('#TransferDetailsDiv').html('');
                    $('#TransferDetailsDiv').html(data.HTML);
                }
                else
                {

                    $('#TransferDetailsDiv').html('');
                    $('#TransferDetailsDiv').html(data.HTML);
                    alert(data.Message);
                }
                $("#ErrorMessage").hide();
                $('.spinner').hide();
            },
            error: function () {
                alert("Error occured while processing your request.");
            }
        });
    }
</script>

<header class="header fixed-top" style="position:fixed;background-color:lightgray;padding:6px;width:100%;margin-top:0%;">
    <div class="fixhead">
        <b class="CodeSt">@Model.Header</b>
        <span class="tools pull-right">
            <a href="~/Vehicles/MasterGrid/Index?ViewDataId=@Model.ViewDataId&Module=@Model.Module&TableName=@Model.TableName&OptionType=@Model.OptionType&OptionCode=@Model.OptionCode&Header=@Model.Header&Controller2=@Model.Controller2&MainType=@Model.MainType" class="btn btn-danger" style="color:white;font-weight:bolder;font-size:13px;padding:3px 10px;" id="Cancel2">X</a>
        </span>
        <span class="tools pull-right">
            <b class="CodeSt">@Model.Mode Mode</b>
        </span>
        <button class="fa fa-heart pull-right" type="submit" onclick="AddToFavorite('@Model.ViewDataId','@Model.OptionCode')" title="Add/Remove from My Favorites" id="MyFavorites" style="color: rgb(145,142,142); background-color: transparent; border: none; font-size: 20px; height: 27px; margin-right: 5px;margin-top:5px;" name="MyFavorites"></button>

    </div>
</header>
<section class="panel" style="margin-bottom:0px;">
    <div class="panel-body" style="overflow:scroll;">
        <div class="form-horizontal " id="ServiceMaster" role="form" style="margin-top:2%;">
            <div id="ErrorMessage" name="ErrorMessage" class="alert alert-danger" style="display: none"></div>
            <div class="col-sm-12" id="">
                <br />
                <div class="form-group">
                    @if (Model.Mode == "Add")
                    {
                        <label class="col-sm-1  control-label" style="font-weight: bold;">Stock List :</label>
                        <div class="col-sm-2 ">
                            @Html.DropDownListFor(m => m.StockStatusList, DropdownHelper.EmptyList(), new { @class = "form-control" })
                        </div>
                        <div class="col-sm-1 ">
                            <button type="button" style="height:28px;padding-top:4px;" class="btn btn-primary" id="PickData">Pick Stock</button>
                        </div>

                    }
                    <div class="col-sm-2 hidden" style="float:right;">
                        @if (Model.TransferToStock == "New")
                        {
                            <input type="checkbox" data-toggle="toggle" id="StockID" data-onstyle="warning" data-offstyle="info" data-on="New Stock" data-off="Transfer Stock" style="width: 73px !important;height: 34px;">
                        }
                        else
                        {
                            <input type="checkbox" data-toggle="toggle" id="StockID" data-onstyle="info" data-offstyle="warning" data-on="Transfer Stock" data-off="New Stock" style="width: 73px !important;height: 34px;">
                        }
                    </div>
                </div>
                <div class="tab">
                    <button class="tablinks" onclick="openCity(event, 'StockDetails')" id="FirstTab" style="width:100px;">Stock Details</button>
                    <button class="tablinks" onclick="openCity(event, 'TransferDetails')" id="SecondTab" style="width:120px;">Transfer Details</button>
                    <button class="tablinks" onclick="openCity(event, 'HistoryDetails')" id="ThirdTab" style="width:120px;">History Details</button>
                    <button class="tablinks" onclick="openCity(event, 'NewStockDetails')" id="FourthTab" style="width:120px;">New Stock Details</button>
                </div>
                <div id="StockDetails" style="height:400px;" class="tabcontent">
                    <div class="container-fluid ">
                        <div class="form-group" id="StockDetailsDiv">
                            @Html.Partial("_StockDetailsPartialView", Model)
                        </div>
                    </div>
                </div>
                <div id="TransferDetails" style="height:400px;" class="tabcontent">
                    <div class="container-fluid">
                        <div class="form-group" id="TransferDetailsDiv">
                            @Html.Partial("_TransferPartialView", Model)
                        </div>
                    </div>
                </div>
                <div id="HistoryDetails" style="height:400px;" class="tabcontent">
                    <div class="container-fluid">
                        <div class="form-group" id="HistoryDetailsDiv">
                            @Html.Partial("_HistoryPartialView", Model)
                        </div>
                    </div>
                </div>
                <div id="NewStockDetails" style="height:400px;" class="tabcontent">
                    <div class="container-fluid">
                        <div class="form-group">
                            <label class="col-sm-1 control-label" style="font-weight: bold;">VehicleNO :</label>
                            <div class="col-sm-2">
                                @Html.DropDownListFor(m => m.RelatedChoice, DropdownHelper.EmptyList(), new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group" style="min-height:360px;max-height:360px;overflow:auto;">
                            <div class="col-sm-8" id="TruckRelatedDiv" style="padding:0px!important;margin:0px!important;">
                                @Html.Partial("_NewStockPartialView", Model)
                            </div>
                            <div class="col-sm-4 " id="TruckRelatedStockDiv" style="padding:0px!important;margin:0px!important;">

                                @Html.Partial("_NewTyreStockPartialView", Model)

                            </div>

                        </div>
                    </div>
                </div>

                <script>
                    function openCity(evt, cityName) {
                        var i, tabcontent, tablinks;
                        tabcontent = document.getElementsByClassName("tabcontent");
                        for (i = 0; i < tabcontent.length; i++) {

                            tabcontent[i].style.display = "none";
                        }
                        tablinks = document.getElementsByClassName("tablinks");
                        for (i = 0; i < tablinks.length; i++) {

                            tablinks[i].className = tablinks[i].className.replace(" active", "");
                        }
                        if (cityName == "HistoryDetails") {
                            History();
                        }
                        document.getElementById(cityName).style.display = "block";
                        evt.currentTarget.className += " active";
                    }
                    document.getElementById("FirstTab").click();
                </script>
            </div>
        </div>
    </div>
</section>
<footer class="footer-section" style="height:33px;position:fixed;background-color:#4B4A4A;padding:3px;color:white;">
    <div class="row">
        <div class="col-sm-5">

        </div>
        <div class="col-sm-3" style="margin-top:4px;color:white;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
            T.FAT ERP-iX9, Suchan Software Private Limited
        </div>
        <div class="col-sm-4">
            <div class="pull-right" style="padding-left:5px;">
            </div>
            <div class="pull-right">
                @if (Model.Mode != "View")
                {
                    if (Model.Mode == "Delete")
                    {
                        <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnDelete">Delete</button>
                    }
                    else
                    {
                        <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="Submit">Save</button>
                    }
                }
                <a href="~/Vehicles/MasterGrid/Index?ViewDataId=@Model.ViewDataId&Module=@Model.Module&TableName=@Model.TableName&OptionType=@Model.OptionType&OptionCode=@Model.OptionCode&Header=@Model.Header&Controller2=@Model.Controller2&MainType=@Model.MainType" class="btn btn-danger" style="font-size: 13px;padding:3px 12px;" id="Cancel">Cancel</a>
            </div>

        </div>
    </div>
</footer>
@Html.HiddenFor(x => x.Document)
@Html.HiddenFor(x => x.Mode)
@Html.HiddenFor(x => x.OldStkTyreSerialNo)
<div class="example-modal">
    <div id="pickuplist" class="modal modal-default">
        <div class="modal-dialog modal-lg" @*style="width:1240px;height:500px;"*@>
            <div id="PickUpList">
                @Html.Partial("PickUp")
            </div>
        </div>
    </div>
</div>



