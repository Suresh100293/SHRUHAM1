@model ALT_ERP3.Models.UserProfileVM
@{
    Layout = null;
}
<!DOCTYPE html>
<style>
    .form-signin h2.form-signin-heading {
        text-align: left;
    }

    .form-signin input[type="text"],
    .form-signin input[type="password"] {
        font-size: medium;
        color: black;
    }

    .form-control {
        height: 28px;
        border: 1px solid #9c9c9c;
        color: black;
        padding: 4px 4px 4px 6px;
    }

    .background_img {
        /*background-image: url('../../Content/images/HourGlass.jpg');*/
        /*background-image: url('../../Content/images/gears-mechanism.jpg');*/
        /*background-image: url('../../Content/images/Gears-Eye.jpg');*/
        /*background-image: url('../../Content/images/GreenField.jpg');*/
        /*background-image: url('../../Content/images/Book-Spring.jpg');*/
        /*background-image: url('../../Content/images/Canvas.jpg');*/
       /*background-image: url('../../Content/images/Shruham.jpeg');*/
        background-image: url('../../Content/images/Shruham.jpeg');
    }
</style>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Shruham Software">
    <link rel='shortcut icon' href='~/Content/images/LogoIco.ico' type='image/x-icon' />
    <title>Login</title>
    <!--Core CSS -->
    <link href="~/Content/bs3/css/bootstrap.min.css" rel="stylesheet">
    <link href="~/Content/css/bootstrap-reset.css" rel="stylesheet">
    <link href="~/Content/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="~/Content/css/style.css" rel="stylesheet">
    <link href="~/Content/css/style-responsive.css" rel="stylesheet" />
    <script src="~/Content/js/jquery.js"></script>
    <script src="~/Content/bs3/js/bootstrap.min.js"></script>
</head>

<body class="login-body background_img" style="background-color:#12506F;background-image: url('../../Content/images/Shruham.jpeg');">
    <div class="container">
        @using (Html.BeginForm("Login", "Account", FormMethod.Post, new
        { @class = "form-signin", @role = "FormPost", @Style = "height:500px;max-width:400px;margin-top:3%;opacity:0.95;box-shadow: 1px 1px 50px 15px rgba(0,0,0,0.75);" }
        ))
        {
            <div class="login-wrap" style="height:460px;">
                <div class="form-signin-heading" style="background-color:white;justify-content:center;">
                    <center><img src="~/Content/images/ShruhamLogin.jpeg" style="margin-top:0px;height:100px;width:300px;" /></center>
                </div>
                <div style="color:gray;margin-top:0%;font-size:9px;">
                    Copyright ©2021 Shruham Software. All Rights Reserved.
                    <a class="pull-right" href="~/EULA.htm" style="color:gray;">License Agreement</a>
                </div>
                <br />
                <div class="user-login-info" style="background-color:white; height:110px;">
                    <div class="form-group has-feedback">
                        <a class="pull-right" id="newuser" href="" style="color:black;font-size:smaller;">New User? SignUp</a>
                        <label style="color:black;font-weight:normal;">Customer ID:</label>
                        @Html.TextBoxFor(m => m.TfatPass_CorpID, new { @class = "form-control", placeholder = "Customer ID", @Style = "background-color:#dcefff;border-color:#9a9a9a;font-weight:bolder;font-size:12px;" })
                    </div>
                    <div class="form-group has-feedback">
                        <label style="color:black;font-weight:normal;">Email ID / Mobile:</label>
                        <a class="pull-right" id="verifyuser" href="" style="color:black;font-size:smaller;display:none;">Verify Email/Mobile</a>
                        @Html.TextBoxFor(m => m.TfatPass_Email, new { @class = "form-control", @id = "userid", placeholder = "Email ID / Mobile", @Style = "background-color:white;border-color:#9a9a9a;font-weight:bolder;font-size:12px;" })
                        <span class="glyphicon glyphicon-user form-control-feedback"></span>
                    </div>
                    <div id="divpassword" style="visibility:visible;" class="form-group has-feedback">
                        <label id="labelpassword" style="color:black;font-weight:normal;">Password:</label>
                        <a class="pull-right" id="forgotpassword" href="" style="color:black;font-size:smaller;">forgot Password</a>
                        @*onclick="RequestLoginOTP()"*@
                        <a class="pull-right" id="requestotp" href="" style="color:black;font-size:smaller;display:none;">Request OTP</a>
                        @Html.TextBoxFor(m => m.TfatPass_PassWords, new { @Type = "Password", @class = "form-control", placeholder = "Password", @Style = "background-color:white;border-color:#9a9a9a;font-weight:bolder;font-size:12px;" })
                        <span class="glyphicon glyphicon-briefcase form-control-feedback"></span>
                    </div>
                    <div class="form-group">
                        <label class="checkbox" style="color:black;font-weight:unset;">
                            @Html.CheckBoxFor(m => m.TfatPass_Remember)
                            Remember my User-ID
                        </label>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-info" type="submit" style="color:white;width:101px;margin:unset;padding:6px 25px;">Sign in</button>
                        <label id="labelotp" style="color:black;display:none;font-weight:normal;">&nbsp;&nbsp;OTP is Required:</label>
                        <div class="col-sm-5 pull-right" id="divotp" style="padding-right:0px;display:none;">
                            @Html.TextBoxFor(m => m.TfatPass_LastBranch, new { @class = "form-control", @id = "otp", placeholder = "OTP", @MaxLength = 6, @Style = "text-align:center;border-color:#9a9a9a;font-weight:bolder;font-size:16px;padding:5px;" })
                        </div>
                    </div>
                    @*<br />*@
                    @Html.ValidationSummary(true, "", new { @style = "color:red;" })
                </div>
            </div>
        }
    </div>

    <div class="example-modal">
        <div id="dialoguser" class="modal modal-primary" style="z-index:2100;">
            <div class="modal-dialog" style="width:600px;height:600px;">
                <div id="Dialog">
                    @Html.Partial("NewUser")
                </div>
            </div>
        </div>
    </div>
    <div class="example-modal">
        <div id="dialogverify" class="modal modal-primary" style="z-index:2100;">
            <div class="modal-dialog" style="width:600px;height:600px;">
                <div id="Dialogverify">
                    @Html.Partial("VerifyUser")
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script type="text/javascript">
    $(document).ready(function () {
        GetUserDetails();
        $('#requestotp').click(function (event) {
            event.preventDefault();
            RequestLoginOTP();
        });

        $('#newuser').click(function (event) {
            event.preventDefault();
            $('#dialoguser').modal({
                backdrop: 'static',
                keyboard: false
            });
            $('#dialoguser').modal('show');
        });

        $('#verifyuser').click(function (event) {
            event.preventDefault();
            $('#dialogverify').modal({
                backdrop: 'static',
                keyboard: false
            });
            $('#dialogverify').modal('show');
        });

        $('#forgotpassword').click(function (event) {
            event.preventDefault();
            var url = '@Url.Action("ForgotPassword")?emailid='+$('#userid').val();
            $.ajax({
                type: "POST",
                dataType: "json",
                data: '',
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                success: function (result) {
                    if (result.Status == "Success") {
                        alert("Password is Sent to your EmailID..")
                    } else {
                        alert("Error! Try Again..")
                    }
                },
                error: function () {
                    alert("An error occurred while processing the request.");
                }
            });
        });
    });

    $('#userid').focusout(function () {
        GetUserDetails();
    });

    function GetUserDetails(){
        var url = '@Url.Action("GetUserDetails")?emailid='+$('#userid').val();
        $.ajax({
            type: "POST",
            dataType: "json",
            data: '',
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $('#hdnuserid').val(result.userid);
                if (result.Emailverified == false || result.mobileverified == false) {
                    $('#verifyuser').show();
                } else {
                    $('#verifyuser').hide();
                }
                if (result.otpreqd == true) {
                    $('#requestotp').show();
                    $('#labelotp').show();
                    $('#divotp').show();
                    //$('#labelpassword').text('Enter OTP');
                } else {
                    $('#requestotp').hide();
                    $('#labelotp').hide();
                    $('#divotp').hide();
                    //$('#labelpassword').text('Enter Password');
                }
            },
            error: function () {
                alert("An error occurred while processing the request.");
            }
        });
    }

    function RequestLoginOTP() {
        var url = '@Url.Action("RequestLoginOTP")?UserID=' + $('#userid').val();
        $.ajax({
            type: "POST",
            dataType: "json",
            data: '',
            cache: false,
            url: url,
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                alert(result.Message);
            },
            error: function () {
                alert("An error occurred while processing the request.");
            }
        });
    }
</script>
@Html.HiddenFor(x => x.TfatPass_Code, new { @Id = "hdnuserid" })