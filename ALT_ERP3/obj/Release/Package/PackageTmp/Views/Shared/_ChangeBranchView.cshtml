
@model ALT_ERP3.Complogin
@using Common
<script>
    $(document).ready(function () {
        loadb();
        $('#btnTfatBranch').click(function (event) {
            event.preventDefault();
            
            var ModelData = {};
            ModelData["UserId"] = $("#hdnUserId1").val();
            ModelData["CompCode"] = $("#hdnCompCode1").val();
            ModelData["BranchCode"] = $("#BranchCode").val();
            ModelData["perd"] = $("#hdnCperd1").val();

            var DTO = { Model: ModelData };
            var url = '@Url.Action("UpdateBranch")';
            $.ajax({
                type: "POST",
                dataType: "json",
                data: JSON.stringify(DTO),
                cache: false,
                url: url,
                contentType: "application/json;charset=utf-8",
                beforesend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    $('#ChangeBRanchModal').modal('hide');
                   
                    //location.reload();
                    window.location.href = "/DashBoard/TransactionsDashBoard";
                    //window.location.href = '@Url.Action("TransactionsDashBoard", "DashBoard")' ;
                },
                error: function () {
                    $('.spinner').hide();
                    alert("error occured while processing your request.");
                }
            });
        });
    });
    function loadb() {
        debugger;
        $("#BranchCode").empty();
        var ModelData = {};
        ModelData["UserId"] = $("#hdnUserId1").val();
        ModelData["CompCode"] = $("#hdnCompCode1").val();    
        var url = '@Url.Action("ChangeGetBranchList")';
        $.ajax({
                type: "POST",
                traditional: true,
                url: url,
            data: { CompCode: $("#hdnCompCode1").val(), UserId: $("#hdnUserId1").val() },
            success: function (result) {
                $.each(result, function (i, item) {
                    $("#BranchCode").append("<option value='" + item.Value + "'>" +  item.Text + "</option>");
                });
            },

            error: function () {
                $('.spinner').hide();
                alert("An error occurred while processing the request.");
            }
            });
    }
</script>

<div class="modal-body">
    <div class="modal-content">
        <div class="modal-header" style="background-color:#cccccc;padding-top:5px;">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title"><b>Change Plant / Unit</b></h4>
        </div>
            <div class="modal-body">
                <div class="grid" id="FormatTable" style="max-height:50px;min-height:50px; width:100%; ">
                    <div id="" class="" style="width:100%;">
                        <div class="form-group">
                            <div class="col-sm-offset-1 col-sm-3" style="padding-top: 5px;">
                                <label class="col-sm-12 control-label" style="font-weight:bold;color:black;font-size: 16px;">Branch :</label>
                            </div>
                            <div class="col-sm-7">
                                @Html.DropDownListFor(m => m.BranchCode, DropdownHelper.EmptyList(), new { @class = "form-control BranchCombo", @style = "height:37px;text-align-last: center;text-align:center;font-weight:bold;font-size: 15px;" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <div class="modal-footer" style="background-color:#cccccc;height:42px;padding-bottom:5px;padding-top:5px;border-radius: 0px 0px 5px 5px;">
            <button id="btnTfatBranch" class="btn btn-success" type="button">Update</button>
            <button data-dismiss="modal" class="btn btn-danger" type="button">Close</button>
        </div>
    </div>
</div>
@Html.HiddenFor(x => x.UserId, new { Id = "hdnUserId1" })
@Html.HiddenFor(m => m.CompCode, new { Id = "hdnCompCode1" })
@Html.HiddenFor(m => m.perd, new { Id = "hdnCperd1" })