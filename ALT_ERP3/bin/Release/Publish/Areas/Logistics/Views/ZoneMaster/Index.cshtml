@model TFATERPWebApplication.Areas.Accounts.Models.GridOption
@using Common;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_NEWLayoutMenu.cshtml";
}




<style>


    .ui-jqgrid tr.jqgrow td {
        vertical-align: middle;
        font-family: Tahoma;
        font-size: 9pt;
        text-align: center;
    }

    .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default {
        border: 1px solid #A9A9A9;
    }

    .ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus {
        border: 1px solid gray;
    }

    .btncolor {
        background-color: slategray;
        color: white;
    }

    .ui-widget-content {
        background: unset;
    }

    .ui-jqgrid .ui-pg-table td {
        font-size: 9pt;
        font-family: Tahoma;
        text-align: center;
    }

    .ui-jqgrid .ui-paging-info {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .ui-jqgrid .ui-pg-input {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .ui-jqgrid .ui-pg-selbox {
        font-size: 9pt;
        font-family: Tahoma;
    }

    .ui-jqdialog {
        display: none;
        width: 300px;
        position: absolute;
        padding: .2em;
        font-size: 11px;
        overflow: visible;
        left: 30% !important;
        top: 35% !important;
        background-color: whitesmoke;
    }

    .ui-jqdialog-titlebar {
        background-color: gray;
    }
</style>

<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>
<script src="~/Scripts/jquery.jstree.js"></script>

<script>
    var isTreeOpen = false;
    $(document).ready(function () {




        FillTreeView();
      

        //ExpandOrCollapse();

         $('#treeviewcontrol').click(function (event) {
            event.preventDefault();
            $("#ErrorMessage").hide();
            var divId = [];
            $("#treeviewcontrol").jstree("get_selected").each(function (key, value) {
                divId.push(this.id);
            });
            if (divId == '') { return; }
             var url = '@Url.Action("TreeNodeClick")?Id=' + divId.toString();
             $('#hdnID').val(divId);
            $.ajax({
                type: "POST",
                dataType: "json",
                cache: false,
                url: url,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                    $('.spinner').show();
                },
                success: function (data) {
                    $('.spinner').hide();
                    $('#adddiv').html(data.Html);
                },
            });
        });

        $('#deletegroup').click(function (event) {
            event.preventDefault();
            $("#ErrorMessage").hide();
            var divId = [];
            $("#treeviewcontrol").jstree("get_selected").each(function (key, value) {
                divId.push(this.id);
            });
            var url = '@Url.Action("DeleteAccountGroups")?Id=' + + divId.toString();
            $.ajax({
                type: "POST",
                dataType: "json",
                cache: false,
                url: url,
                contentType: "application/json; charset=utf-8",
                beforeSend: function () {
                },
                success: function (data) {
                    $('.spinner').hide();
                    $('#adddiv').html(data.Html);
                    if (data.Status == 'Success') {
                        $('.spinner').hide();
                        $("#ErrorMessage").hide();
                        $('#adddiv').empty();
                        FillTreeView();
                    }
                    else if (data.Status == 'Error') {
                        alert(data.Message);
                        $('#adddiv').empty();
                        FillTreeView();
                    }
                    else {
                        $("#ErrorMessage").show();
                        $("#ErrorMessage").html(data.html);
                        $('#adddiv').empty();
                        FillTreeView();
                    }
                },
            });
        });



        $('#expandall').click(function () {
            

            ExpandOrCollapse();

        });

    });

    function ExpandOrCollapse() {
        if (isTreeOpen == false) {
            $("#treeviewcontrol").jstree("open_all", "#0");
            isTreeOpen = true;
        } else {
            $("#treeviewcontrol").jstree("close_all", "#0");
            isTreeOpen = false;
        }
    }

    function FillTreeView() {
        $("#treeviewcontrol").jstree({
            json_data: {
                "ajax": {
                    "url": "/ZoneMaster/TreeView",
                    "type": "POST",
                    "dataType": "json",
                    "contentType": "application/json charset=utf-8"
                }
            },
            checkbox: {
                real_checkboxes: false,
                checked_parent_open: false
            },
            plugins: ["themes", "json_data", "ui", ""]
        });
    };

</script>



<header class="header fixed-top" style="position:fixed;background-color:lightgray;padding:6px;width:100%;margin-top:5px;">
    <div class="fixhead">
        <b class="CodeSt">Tree Group</b>
        <span class="tools pull-right">
            <a href="~/DashBoard/MasterDashBoard" class="btn btn-danger" style="color:white;font-weight:bolder;font-size:13px;padding:3px 10px;" id="Cancel2">X</a>
        </span>
    </div>
</header>

<section class="panel" style="margin-top: 25px;">
    <div class="panel-body">
        <div class="form-horizontal " id="view" role="form" style="margin-top:0px;">
            <div id="ErrorMessage" name="ErrorMessage" class="alert alert-danger" style="display: none"></div>
            <div class="form-group" style="margin-top:0px;">
                <div class="col-sm-3">
                    <div id="treeviewcontrol" style="font-family:Tahoma;font-size:12px;border-right:double; min-height:500px;overflow-y:auto;max-height:500px;padding-left:5px;padding-top:10px;padding-bottom:5px;"></div>
                </div>
                <div id="adddiv">
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="footer-section" style="height:33px;position:fixed;background-color:#4B4A4A;padding:3px;color:white;">
    <div class="row">
        <div class="col-sm-5">
            <div class="pull-left">

                @*<button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="addchild">Add Child</button>

                    <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnZone">Add Zone</button>
                    <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnBranch">Add Branch</button>
                    <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnArea">Add Area</button>
                    <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="btnSubBranch">Add Sub-Branch</button>*@

                <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="expandall">Expand All / Collapse All</button>
                <button class="btn btn-danger" style="font-size: 13px;padding:3px 12px;" id="deletegroup">Delete Item</button>
            </div>
        </div>
        <div class="col-sm-5" style="margin-top:6px;color:white;font-family:Tahoma;font-size:8pt;">
            T.LAT ERP-iX 3.0, Suchan Software Private Limited&nbsp;&nbsp;<span style="color: aqua;">(@Session["BranchCode"])</span>&nbsp;&nbsp; <span style="color: blanchedalmond;">@Session["BranchName"]</span>
        </div>

        <div class="col-sm-2">
            <div class="pull-right">
                @*@if (Model.Mode != "View")
                    {
                        <button class="btn btn-success" style="font-size: 13px;padding:3px 12px;" id="SubmitData">Save</button>
                    }*@
                <a href="~/DashBoard/MasterDashBoard" class="btn btn-danger" style="font-size: 13px;padding:3px 12px;margin-right: 10px;" id="Cancel">Cancel</a>
            </div>
        </div>
    </div>
</footer>

<input type="hidden" id="hdnID1" />
