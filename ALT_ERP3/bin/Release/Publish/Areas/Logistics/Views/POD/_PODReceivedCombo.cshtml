@model TFATERPWebApplication.Areas.Logistics.Models.PODReceivedVM
@using Common;
@{
    /**/

    ViewBag.Title = "Delivery Master";
    Layout = null;
}
<script src="@Url.Content("~/Content/js/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/js/jquery.constrain.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        LoadBranch();
    });
    function LoadBranch() {
        var url = '@Url.Action("BranchList")'
        $('#ComingFromBranchPOD').select2({
            minimumInputLength: 0,
            placeholder: 'Search',
            ajax: {
                url: url,
                dataType: 'json',
                quietMillis: 100,
                enableFiltering: true,
                allowClear: true,
                minimumInputLength: 0,
                multiple: true,
                width: 300,
                data: function (term, page) {
                    return {
                        types: ["exercise"],
                        limit: -1,
                        term: term
                    };
                },
                results: function (data, page) {
                    clientObj = JSON.stringify(data);
                    return {
                        results: $.map(data, function (item) {
                            return {
                                text: item.Name,
                                id: item.Code
                            }
                        })
                    };
                }
            },

            initSelection: function (element, callback) {
                var data = { id: '@Model.ComingFromBranchPOD', text: '@Model.ComingFromBranchPOD_Name' };
                callback(data);
            },

            formatResult: function (exercise) {
                return "<div class='row-fluid'><div class=''><span class='span1'><div style='color:" + exercise.alias + "'>" + exercise.text +
                    "</div></span></div></div>";
            },

            formatSelection: function (exercise) {
                
                PODComboList();
                return "<div class='row-fluid'><div class=''><span class='span1'><div style='color:" + exercise.alias + "'>" + exercise.text +
                    "</div></span></div></div>";
            },
        })
    };
    function PODComboList() {
        
        var ModelData = {};
        ModelData["ComingFromBranchPOD"] = $('#ComingFromBranchPOD').val();

        var url = '@Url.Action("ReceivedPodPendingList")';
        var DTO = { mModel: ModelData };
        $.ajax({
            type: "POST",
            dataType: "json",
            data: JSON.stringify(DTO),
            cache: false,
            url: url,
            contentType: "application/json; charset=utf-8",
            beforeSend: function () {
                $('.spinner').show();
            },
            success: function (data) {
                var LoadDownLoadFiles = $("#PendingPOdList");
                $("#ErrorMessage").hide();
                $('.spinner').hide();
                LoadDownLoadFiles.html('');
                LoadDownLoadFiles.html(data.Html);
            },
        });
    }
</script>
<div id="BranchPOD" style="padding:0px !important;margin:0px !important;">
    <div class="form-group">
        <label class=" bold   col-sm-1  control-label">POD No:</label>
        <div class="col-sm-2 ">
            @Html.TextBoxFor(x => x.CpoyPODNO, new { @class = "form-control", @style = "width:100%;", @Value = Model.CpoyPODNO, @disabled = "disabled" })
        </div>
        <label class=" bold   col-sm-1  control-label" style="width:auto;">From:</label>
        <div class="col-sm-2 " id="">
            @Html.TextBoxFor(x => x.ComingFromBranchPOD, new { @class = "input-large-query", @style = "width:100%;", @Value = Model.ComingFromBranchPOD })
        </div>
    </div>
    <div class="form-group" id="PendingPOdList">
        @Html.Partial("_PendingPODReceiveList", Model)
    </div>
</div>
